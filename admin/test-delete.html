<!DOCTYPE html>
<html>
<head>
    <title>Test Delete Client Functionality</title>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
    <div style="padding: 20px;">
        <h2>Test Delete Client Functionality</h2>
        <p>Test Client ID: 21 (Frontend Test Client)</p>
        
        <button onclick="testClientManager()" class="btn btn-info">Test if clientManager exists</button>
        <button onclick="clientManager.deleteClient(21)" class="btn btn-danger">Delete Test Client (ID: 21)</button>
        
        <div id="output" style="margin-top: 20px; padding: 10px; background: #f5f5f5; border-radius: 5px;"></div>
    </div>

    <script>
        // Client Manager object
        window.clientManager = {
            async deleteClient(clientId) {
                document.getElementById('output').innerHTML += '<br>Delete function called with ID: ' + clientId;
                
                if (!confirm('Are you sure you want to delete this client? This action cannot be undone and will remove all associated data including their website, uploads, and user account.')) {
                    document.getElementById('output').innerHTML += '<br>User cancelled deletion';
                    return;
                }
                
                document.getElementById('output').innerHTML += '<br>User confirmed deletion, making API call...';
                
                try {
                    const response = await fetch(`/api/system-management/clients/${clientId}`, {
                        method: 'DELETE',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });
                    
                    const result = await response.json();
                    document.getElementById('output').innerHTML += '<br>API Response: ' + JSON.stringify(result);
                    
                    if (result.success) {
                        alert('Client deleted successfully');
                        document.getElementById('output').innerHTML += '<br>SUCCESS: Client deleted successfully';
                    } else {
                        alert('Error deleting client: ' + result.error);
                        document.getElementById('output').innerHTML += '<br>ERROR: ' + result.error;
                    }
                } catch (error) {
                    console.error('Delete client error:', error);
                    document.getElementById('output').innerHTML += '<br>EXCEPTION: ' + error.message;
                    alert('Failed to delete client. Please try again.');
                }
            }
        };
        
        function testClientManager() {
            const output = document.getElementById('output');
            if (window.clientManager) {
                output.innerHTML += '<br>✅ clientManager exists';
                if (typeof window.clientManager.deleteClient === 'function') {
                    output.innerHTML += '<br>✅ deleteClient method exists';
                } else {
                    output.innerHTML += '<br>❌ deleteClient method NOT found';
                }
            } else {
                output.innerHTML += '<br>❌ clientManager does NOT exist';
            }
        }
    </script>
</body>
</html>