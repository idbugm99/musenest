<!-- Navigation - Universal Component with Theme Classes -->
<!-- This navigation works across all themes using universal CSS variables -->

<nav class="fixed w-full top-0 z-50 transition-all duration-300 theme-nav-bg backdrop-blur-sm border-b theme-border-light" role="navigation" aria-label="Primary">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
            <!-- Brand/Logo -->
            <div class="flex items-center">
                <a href="/{{modelSlug}}{{previewParam}}" class="font-bold text-xl theme-accent hover:opacity-80 transition-opacity">
                    {{siteName}}
                </a>
            </div>
            
            <!-- Desktop Navigation -->
            <div class="hidden md:block">
                <div class="ml-10 flex items-baseline space-x-6" role="menubar">
                    {{#each navigation}}
                    <a href="{{this.url}}" 
                       class="nav-link px-3 py-2 text-sm font-medium theme-text-primary hover:theme-accent transition-colors duration-200 {{#if this.active}}theme-accent{{/if}}" role="menuitem" aria-current="{{#if this.active}}page{{/if}}">
                        {{this.name}}
                    </a>
                    {{/each}}
                </div>
            </div>
            
            <!-- Mobile menu button -->
            <div class="md:hidden">
                <button type="button" 
                        class="inline-flex items-center justify-center p-2 rounded-md theme-text-primary hover:theme-accent hover:theme-bg-light focus:outline-none focus:ring-2 focus:ring-inset focus:theme-accent transition-colors"
                        aria-controls="mobile-menu" 
                        aria-expanded="false"
                        onclick="toggleMobileMenu()">
                    <span class="sr-only">Open main menu</span>
                    <i class="fas fa-bars text-xl" id="menu-icon"></i>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Mobile Navigation Menu -->
    <div class="md:hidden hidden" id="mobile-menu" role="menu" aria-label="Mobile Primary">
        <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3 theme-card-bg theme-border-light border-t">
            {{#each navigation}}
            <a href="{{this.url}}" 
               class="nav-link-mobile block px-3 py-2 text-base font-medium theme-text-primary hover:theme-accent hover:theme-bg-light transition-colors rounded-md {{#if this.active}}theme-accent theme-bg-light{{/if}}" role="menuitem" aria-current="{{#if this.active}}page{{/if}}">
                {{this.name}}
            </a>
            {{/each}}
        </div>
    </div>
</nav>

<!-- Navigation JavaScript -->
<script>
function toggleMobileMenu() {
    const mobileMenu = document.getElementById('mobile-menu');
    const menuIcon = document.getElementById('menu-icon');
    
    if (mobileMenu && menuIcon) {
        if (mobileMenu.classList.contains('hidden')) {
            mobileMenu.classList.remove('hidden');
            menuIcon.classList.remove('fa-bars');
            menuIcon.classList.add('fa-times');
        } else {
            mobileMenu.classList.add('hidden');
            menuIcon.classList.remove('fa-times');
            menuIcon.classList.add('fa-bars');
        }
    }
}

// Close mobile menu when clicking outside
document.addEventListener('click', function(event) {
    const mobileMenu = document.getElementById('mobile-menu');
    const mobileButton = event.target.closest('[aria-controls="mobile-menu"]');
    
    if (mobileMenu && !mobileMenu.classList.contains('hidden') && !mobileButton && !mobileMenu.contains(event.target)) {
        toggleMobileMenu();
    }
});

// Close mobile menu on escape key
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        const mobileMenu = document.getElementById('mobile-menu');
        if (mobileMenu && !mobileMenu.classList.contains('hidden')) {
            toggleMobileMenu();
        }
    }
});
</script>

<!-- Navigation Styles -->
<style>
/* Universal Navigation Theming */
.theme-nav-bg {
    background: rgba(var(--theme-bg-primary-rgb, 255, 255, 255), 0.95);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
}

/* Navigation link hover effects */
.nav-link {
    position: relative;
    border-radius: 6px;
    transition: all 0.2s ease;
}

.nav-link:hover {
    transform: translateY(-1px);
}

.nav-link.theme-accent {
    font-weight: 600;
}

/* Mobile navigation enhancements */
.nav-link-mobile {
    transition: all 0.2s ease;
}

.nav-link-mobile:hover {
    transform: translateX(4px);
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .theme-nav-bg {
        background: rgba(var(--theme-bg-primary-rgb, 255, 255, 255), 1);
        backdrop-filter: none;
    }
}

/* Smooth mobile menu animation */
#mobile-menu {
    transition: all 0.3s ease;
}

#mobile-menu:not(.hidden) {
    animation: slideDown 0.3s ease;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Focus styles for accessibility */
.nav-link:focus,
.nav-link-mobile:focus {
    outline: 2px solid var(--theme-accent);
    outline-offset: 2px;
}

/* Brand hover effect */
.theme-accent:hover {
    filter: brightness(1.1);
}
</style>