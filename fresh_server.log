
> musenest@1.0.0 dev
> nodemon server.js

[33m[nodemon] 3.1.10[39m
[33m[nodemon] to restart at any time, enter `rs`[39m
[33m[nodemon] watching path(s): *.*[39m
[33m[nodemon] watching extensions: js,mjs,cjs,json[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Impersonation middleware called for: /api/auth/me
Query test with limit/offset interpolation
Query executed successfully, got 4 items
Approve blur request for ID: 73
Request body: {
  blur_settings: {
    strength: 15,
    opacity: 0.8,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 15,
    "opacity": 0.8,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753634605469_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753634963146_1753634605469_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
Using admin interface coordinates directly:
  Auto-rotated coords: x=1023, y=1401, w=653, h=729
Final blur coordinates for processing: 1023,1401 653x729
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753634963146_1753634605469_20250622_003419_debug_breast.jpg
Extracted from AUTO-ROTATED image at: 1023,1401 653x729
Applied blur radius: 15px (15px setting)
Applied white overlay with 80% opacity (enhanced from 80%)
Preparing for composite at: 1023,1401
Applying 1 blur regions in single composite operation
Image processed with auto-rotation - no additional rotation needed
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753634963146_1753634605469_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753634605469_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753634605469_20250622_003419.jpg
Updating content_moderation record with ID: 75
Blur settings JSON: {"strength":15,"opacity":0.8,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 75
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 3 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Impersonation middleware called for: /api/auth/me
Query test with limit/offset interpolation
Query executed successfully, got 3 items
Approve blur request for ID: 72
Request body: {
  blur_settings: {
    strength: 15,
    opacity: 0.8,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 15,
    "opacity": 0.8,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753634601060_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753635179297_1753634601060_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1023, y=1401, w=653, h=729
  Raw coords: x=1401, y=1268, w=729, h=653
Final blur coordinates for processing: 1401,1268 729x653
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753635179297_1753634601060_20250622_003419_debug_breast.jpg
Extracted from RAW image at: 1401,1268 729x653
Applied blur radius: 15px (15px setting)
Applied white overlay with 80% opacity (enhanced from 80%)
Preparing for composite at: 1401,1268
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753635179297_1753634601060_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753634601060_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753634601060_20250622_003419.jpg
Updating content_moderation record with ID: 74
Blur settings JSON: {"strength":15,"opacity":0.8,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 74
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 2 items
Impersonation middleware called for: /api/auth/me
Query test with limit/offset interpolation
Query executed successfully, got 2 items
Approve blur request for ID: 46
Request body: {
  blur_settings: {
    strength: 4,
    opacity: 0.2,
    shape: 'rounded',
    blurredParts: [ 'genitalia', 'custom_1753635379983' ],
    overlayPositions: { genitalia: [Object], custom_1753635379983: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 4,
    "opacity": 0.2,
    "shape": "rounded",
    "blurredParts": [
      "genitalia",
      "custom_1753635379983"
    ],
    "overlayPositions": {
      "genitalia": {
        "x": 2069,
        "y": 2340,
        "width": 538,
        "height": 645,
        "confidence": 26.578259468078613
      },
      "custom_1753635379983": {
        "x": 738,
        "y": 1531,
        "width": 1414,
        "height": 502,
        "confidence": 100
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 4,
  opacity: 0.2,
  shape: 'rounded',
  blurredParts: [ 'genitalia', 'custom_1753635379983' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2340,
      width: 538,
      height: 645,
      confidence: 26.578259468078613
    },
    custom_1753635379983: { x: 738, y: 1531, width: 1414, height: 502, confidence: 100 }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 4,
  opacity: 0.2,
  shape: 'rounded',
  blurredParts: [ 'genitalia', 'custom_1753635379983' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2340,
      width: 538,
      height: 645,
      confidence: 26.578259468078613
    },
    custom_1753635379983: { x: 738, y: 1531, width: 1414, height: 502, confidence: 100 }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753603338655_20230703_111727.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753635403579_1753603338655_20230703_111727.jpg
=== COORDINATE DEBUGGING START ===
genitalia coordinates from admin interface: {
  x: 2069,
  y: 2340,
  width: 538,
  height: 645,
  confidence: 26.578259468078613
}
custom_1753635379983 coordinates from admin interface: { x: 738, y: 1531, width: 1414, height: 502, confidence: 100 }
Raw image dimensions: 4000 x 3000 orientation: 1
Auto-rotated image dimensions: 4000 x 3000
Applying selective blur to regions: [ 'genitalia', 'custom_1753635379983' ]
Processing blur for genitalia (received coords): {
  x: 2069,
  y: 2340,
  width: 538,
  height: 645,
  confidence: 26.578259468078613
}
Auto-rotated image dimensions: 4000x3000
No coordinate transformation needed:
  Direct coords: x=2069, y=2340, w=538, h=645
Final blur coordinates for processing: 2069,2340 538x645
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753635403579_1753603338655_20230703_111727_debug_genitalia.jpg
Extracted from RAW image at: 2069,2340 538x645
Applied blur radius: 4px (4px setting)
Applied white overlay with 20% opacity (enhanced from 20%)
Preparing for composite at: 2069,2340
Processing blur for custom_1753635379983 (received coords): { x: 738, y: 1531, width: 1414, height: 502, confidence: 100 }
Auto-rotated image dimensions: 4000x3000
No coordinate transformation needed:
  Direct coords: x=738, y=1531, w=1414, h=502
Final blur coordinates for processing: 738,1531 1414x502
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753635403579_1753603338655_20230703_111727_debug_custom_1753635379983.jpg
Extracted from RAW image at: 738,1531 1414x502
Applied blur radius: 4px (4px setting)
Applied white overlay with 20% opacity (enhanced from 20%)
Preparing for composite at: 738,1531
Applying 2 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753635403579_1753603338655_20230703_111727.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753603338655_20230703_111727.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753603338655_20230703_111727.jpg
Updating content_moderation record with ID: 48
Blur settings JSON: {"strength":4,"opacity":0.2,"shape":"rounded","blurredParts":["genitalia","custom_1753635379983"],"overlayPositions":{"genitalia":{"x":2069,"y":2340,"width":538,"height":645,"confidence":26.578259468078613},"custom_1753635379983":{"x":738,"y":1531,"width":1414,"height":502,"confidence":100}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 48
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 1 items
Approve blur request for ID: 71
Request body: {
  blur_settings: {
    strength: 5,
    opacity: 0.2,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 5,
    "opacity": 0.2,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1453,
        "y": 1732,
        "width": 223,
        "height": 314,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 5,
  opacity: 0.2,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1453,
      y: 1732,
      width: 223,
      height: 314,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 5,
  opacity: 0.2,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1453,
      y: 1732,
      width: 223,
      height: 314,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753634596928_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753635433943_1753634596928_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1453,
  y: 1732,
  width: 223,
  height: 314,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1453,
  y: 1732,
  width: 223,
  height: 314,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1453, y=1732, w=223, h=314
  Raw coords: x=1732, y=1268, w=314, h=223
Final blur coordinates for processing: 1732,1268 314x223
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753635433943_1753634596928_20250622_003419_debug_breast.jpg
Extracted from RAW image at: 1732,1268 314x223
Applied blur radius: 5px (5px setting)
Applied white overlay with 20% opacity (enhanced from 20%)
Preparing for composite at: 1732,1268
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753635433943_1753634596928_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753634596928_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753634596928_20250622_003419.jpg
Updating content_moderation record with ID: 73
Blur settings JSON: {"strength":5,"opacity":0.2,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1453,"y":1732,"width":223,"height":314,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 73
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 0 items
Query test with limit/offset interpolation
Query executed successfully, got 0 items
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753636344149-384083789.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 77
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753636348654-406280132.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 78
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753636354142-442258654.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 79
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753636358508-495261718.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 80
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753636362821-689000815.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 81
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753636367040-989400173.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 82
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Impersonation middleware called for: /api/auth/me
Query test with limit/offset interpolation
Query executed successfully, got 6 items
Approve blur request for ID: 80
Request body: {
  blur_settings: {
    strength: 4,
    opacity: 0.2,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 4,
    "opacity": 0.2,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1408,
        "y": 1732,
        "width": 269,
        "height": 398,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 4,
  opacity: 0.2,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1408,
      y: 1732,
      width: 269,
      height: 398,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 4,
  opacity: 0.2,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1408,
      y: 1732,
      width: 269,
      height: 398,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753636367044_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753636405696_1753636367044_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1408,
  y: 1732,
  width: 269,
  height: 398,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1408,
  y: 1732,
  width: 269,
  height: 398,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1408, y=1732, w=269, h=398
  Raw coords: x=1732, y=1267, w=398, h=269
Final blur coordinates for processing: 1732,1267 398x269
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753636405696_1753636367044_20250622_003419_debug_breast.jpg
Extracted from RAW image at: 1732,1267 398x269
Applied blur radius: 4px (4px setting)
Applied white overlay with 20% opacity (enhanced from 20%)
Preparing for composite at: 1732,1267
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753636405696_1753636367044_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753636367044_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753636367044_20250622_003419.jpg
Updating content_moderation record with ID: 82
Blur settings JSON: {"strength":4,"opacity":0.2,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1408,"y":1732,"width":269,"height":398,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 82
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 5 items
Approve blur request for ID: 79
Request body: {
  blur_settings: {
    strength: 4,
    opacity: 0.1,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 4,
    "opacity": 0.1,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1419,
        "y": 1774,
        "width": 257,
        "height": 356,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 4,
  opacity: 0.1,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1419,
      y: 1774,
      width: 257,
      height: 356,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 4,
  opacity: 0.1,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1419,
      y: 1774,
      width: 257,
      height: 356,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753636362825_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753636458128_1753636362825_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1419,
  y: 1774,
  width: 257,
  height: 356,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1419,
  y: 1774,
  width: 257,
  height: 356,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1419, y=1774, w=257, h=356
  Raw coords: x=1774, y=1268, w=356, h=257
Final blur coordinates for processing: 1774,1268 356x257
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753636458128_1753636362825_20250622_003419_debug_breast.jpg
Extracted from RAW image at: 1774,1268 356x257
Applied blur radius: 4px (4px setting)
Applied white overlay with 10% opacity (enhanced from 10%)
Preparing for composite at: 1774,1268
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753636458128_1753636362825_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753636362825_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753636362825_20250622_003419.jpg
Updating content_moderation record with ID: 81
Blur settings JSON: {"strength":4,"opacity":0.1,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1419,"y":1774,"width":257,"height":356,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 81
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 4 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Impersonation middleware called for: /api/auth/me
Query test with limit/offset interpolation
Query executed successfully, got 4 items
Approve blur request for ID: 78
Request body: {
  blur_settings: {
    strength: 4,
    opacity: 0.2,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 4,
    "opacity": 0.2,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 4,
  opacity: 0.2,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 4,
  opacity: 0.2,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753636358512_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753636694044_1753636358512_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1023, y=1401, w=653, h=729
  Raw coords: x=1401, y=532, w=729, h=653
Final blur coordinates for processing: 1401,532 729x653
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753636694044_1753636358512_20250622_003419_debug_breast.jpg
Extracted from RAW image at: 1401,532 729x653
Applied blur radius: 4px (4px setting)
Applied white overlay with 20% opacity (enhanced from 20%)
Preparing for composite at: 1401,532
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753636694044_1753636358512_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753636358512_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753636358512_20250622_003419.jpg
Updating content_moderation record with ID: 80
Blur settings JSON: {"strength":4,"opacity":0.2,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 80
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 3 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Approve blur request for ID: 77
Request body: {
  blur_settings: {
    strength: 6,
    opacity: 0.2,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 6,
    "opacity": 0.2,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 6,
  opacity: 0.2,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 6,
  opacity: 0.2,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753636354153_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753636963004_1753636354153_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
Using admin interface coordinates directly:
  Coords: x=1023, y=1401, w=653, h=729
Final blur coordinates for processing: 1023,1401 653x729
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753636963004_1753636354153_20250622_003419_debug_breast.jpg
Extracted from auto-rotated image at: 1023,1401 653x729
Applied blur radius: 6px (6px setting)
Applied white overlay with 20% opacity (enhanced from 20%)
Preparing for composite at: 1023,1401
Applying 1 blur regions in single composite operation
Image already auto-rotated - no additional rotation needed
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753636963004_1753636354153_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753636354153_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753636354153_20250622_003419.jpg
Updating content_moderation record with ID: 79
Blur settings JSON: {"strength":6,"opacity":0.2,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 79
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 2 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Impersonation middleware called for: /api/auth/me
Query test with limit/offset interpolation
Query executed successfully, got 2 items
Approve blur request for ID: 76
Request body: {
  blur_settings: {
    strength: 5,
    opacity: 0.2,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 5,
    "opacity": 0.2,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 5,
  opacity: 0.2,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 5,
  opacity: 0.2,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753636348659_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753637139334_1753636348659_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1023, y=1401, w=653, h=729
  Raw coords: x=1401, y=532, w=729, h=653
Final blur coordinates for processing: 1401,532 729x653
Composite will use admin coordinates after rotation: 1023,1401
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753637139334_1753636348659_20250622_003419_debug_breast.jpg
Extracted from RAW image at: 1401,532 729x653
Applied blur radius: 5px (5px setting)
Applied white overlay with 20% opacity (enhanced from 20%)
Preparing for composite at: 1023,1401
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753637139334_1753636348659_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753636348659_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753636348659_20250622_003419.jpg
Updating content_moderation record with ID: 78
Blur settings JSON: {"strength":5,"opacity":0.2,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 78
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 1 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Impersonation middleware called for: /api/auth/me
Query test with limit/offset interpolation
Query executed successfully, got 1 items
Approve blur request for ID: 75
Request body: {
  blur_settings: {
    strength: 3,
    opacity: 0.2,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 3,
    "opacity": 0.2,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 3,
  opacity: 0.2,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 3,
  opacity: 0.2,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753636344173_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753637345485_1753636344173_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1023, y=1401, w=653, h=729
  Raw coords: x=1401, y=532, w=729, h=653
Final blur coordinates for processing: 1401,532 729x653
Composite will use admin coordinates after rotation: 1023,1401
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753637345485_1753636344173_20250622_003419_debug_breast.jpg
Rotated extracted region 90° clockwise to match final image orientation
Extracted from RAW image at: 1401,532 729x653
Applied blur radius: 3px (3px setting)
Applied white overlay with 20% opacity (enhanced from 20%)
Preparing for composite at: 1023,1401
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753637345485_1753636344173_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753636344173_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753636344173_20250622_003419.jpg
Updating content_moderation record with ID: 77
Blur settings JSON: {"strength":3,"opacity":0.2,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 77
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 0 items
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753638014693-667175890.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 83
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753638018766-398283709.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 84
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Impersonation middleware called for: /api/auth/me
Query test with limit/offset interpolation
Query executed successfully, got 2 items
Approve blur request for ID: 82
Request body: {
  blur_settings: {
    strength: 7,
    opacity: 0.3,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 7,
    "opacity": 0.3,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 7,
  opacity: 0.3,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 7,
  opacity: 0.3,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753638018772_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753638038232_1753638018772_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1023, y=1401, w=653, h=729
  Raw coords: x=1401, y=532, w=729, h=653
Final blur coordinates for processing: 1401,532 729x653
Composite will use admin coordinates after rotation: 1023,1401
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753638038232_1753638018772_20250622_003419_debug_breast.jpg
Rotated extracted region 90° clockwise to match final image orientation
Extracted from RAW image at: 1401,532 729x653
Applied blur radius: 7px (7px setting)
Applied white overlay with 30% opacity (enhanced from 30%)
Preparing for composite at: 1023,1401
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753638038232_1753638018772_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753638018772_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753638018772_20250622_003419.jpg
Updating content_moderation record with ID: 84
Blur settings JSON: {"strength":7,"opacity":0.3,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 84
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 1 items
Approve blur request for ID: 81
Request body: {
  blur_settings: {
    strength: 29,
    opacity: 0.1,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 29,
    "opacity": 0.1,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 29,
  opacity: 0.1,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 29,
  opacity: 0.1,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753638014703_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753638080453_1753638014703_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1023, y=1401, w=653, h=729
  Raw coords: x=1401, y=532, w=729, h=653
Final blur coordinates for processing: 1401,532 729x653
Composite will use admin coordinates after rotation: 1023,1401
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753638080453_1753638014703_20250622_003419_debug_breast.jpg
Rotated extracted region 90° clockwise to match final image orientation
Extracted from RAW image at: 1401,532 729x653
Applied blur radius: 29px (29px setting)
Applied white overlay with 10% opacity (enhanced from 10%)
Preparing for composite at: 1023,1401
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753638080453_1753638014703_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753638014703_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753638014703_20250622_003419.jpg
Updating content_moderation record with ID: 83
Blur settings JSON: {"strength":29,"opacity":0.1,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 83
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 0 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753638272862-272633499.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 85
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753638278244-180913970.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 86
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753638283265-406242376.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 87
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Impersonation middleware called for: /api/auth/me
Query test with limit/offset interpolation
Query executed successfully, got 3 items
Approve blur request for ID: 85
Request body: {
  blur_settings: {
    strength: 8,
    opacity: 0.1,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 8,
    "opacity": 0.1,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 8,
  opacity: 0.1,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 8,
  opacity: 0.1,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753638283272_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753638405799_1753638283272_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1023, y=1401, w=653, h=729
  Raw coords: x=1401, y=532, w=729, h=653
Final blur coordinates for processing: 1401,532 729x653
Composite will use admin coordinates after rotation: 1023,1401
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753638405799_1753638283272_20250622_003419_debug_breast.jpg
Rotated extracted region 90° clockwise to match final image orientation
Extracted from RAW image at: 1401,532 729x653
Applied blur radius: 8px (8px setting)
Applied white overlay with 60% opacity (enhanced from 10%)
Preparing for composite at: 1023,1401
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753638405799_1753638283272_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753638283272_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753638283272_20250622_003419.jpg
Updating content_moderation record with ID: 87
Blur settings JSON: {"strength":8,"opacity":0.1,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 87
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 2 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Approve blur request for ID: 84
Request body: {
  blur_settings: {
    strength: 10,
    opacity: 0.5,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 10,
    "opacity": 0.5,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 10,
  opacity: 0.5,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 10,
  opacity: 0.5,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753638278250_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753638683945_1753638278250_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1023, y=1401, w=653, h=729
  Raw coords: x=1401, y=532, w=729, h=653
Final blur coordinates for processing: 1401,532 729x653
Composite will use admin coordinates after rotation: 1023,1401
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753638683945_1753638278250_20250622_003419_debug_breast.jpg
Rotated extracted region 90° clockwise to match final image orientation
Extracted from RAW image at: 1401,532 729x653
Applied blur radius: 10px (10px setting)
Applied white overlay with 60% opacity (enhanced from 50%)
Preparing for composite at: 1023,1401
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753638683945_1753638278250_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753638278250_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753638278250_20250622_003419.jpg
Updating content_moderation record with ID: 86
Blur settings JSON: {"strength":10,"opacity":0.5,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 86
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 1 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Impersonation middleware called for: /api/auth/me
Query test with limit/offset interpolation
Query executed successfully, got 1 items
Approve blur request for ID: 83
Request body: {
  blur_settings: {
    strength: 7,
    opacity: 0.1,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 7,
    "opacity": 0.1,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 7,
  opacity: 0.1,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 7,
  opacity: 0.1,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753638272871_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753638897343_1753638272871_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1023, y=1401, w=653, h=729
  Raw coords: x=1401, y=532, w=729, h=653
Final blur coordinates for processing: 1401,532 729x653
Composite will use admin coordinates after rotation: 1023,1401
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753638897343_1753638272871_20250622_003419_debug_breast.jpg
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 7px blur...
DEBUG: Saved blurred region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753638897343_1753638272871_20250622_003419_debug_blur_breast.jpg
Extracted from RAW image at: 1401,532 729x653
Applied blur radius: 7px (7px setting)
Applied white overlay with 60% opacity (enhanced from 10%)
Preparing for composite at: 1023,1401
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753638897343_1753638272871_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753638272871_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753638272871_20250622_003419.jpg
Updating content_moderation record with ID: 85
Blur settings JSON: {"strength":7,"opacity":0.1,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 85
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 0 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753639206528-691136095.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 88
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753639213913-218877961.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 89
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Query test with limit/offset interpolation
Query executed successfully, got 20 items
Query test with limit/offset interpolation
Query executed successfully, got 2 items
Approve blur request for ID: 87
Request body: {
  blur_settings: {
    strength: 7,
    opacity: 0.2,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 7,
    "opacity": 0.2,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 7,
  opacity: 0.2,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 7,
  opacity: 0.2,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753639213919_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753639237741_1753639213919_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1023, y=1401, w=653, h=729
  Raw coords: x=1401, y=532, w=729, h=653
Final blur coordinates for processing: 1401,532 729x653
Composite will use admin coordinates after rotation: 1023,1401
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753639237741_1753639213919_20250622_003419_debug_breast.jpg
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 7px blur...
DEBUG: Saved blurred region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753639237741_1753639213919_20250622_003419_debug_blur_breast.jpg
Extracted from RAW image at: 1401,532 729x653
Applied blur radius: 7px (7px setting)
Applied white overlay with 20% opacity (enhanced from 20%)
Preparing for composite at: 1023,1401
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753639237741_1753639213919_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753639213919_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753639213919_20250622_003419.jpg
Updating content_moderation record with ID: 89
Blur settings JSON: {"strength":7,"opacity":0.2,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 89
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 1 items
Impersonation middleware called for: /api/auth/me
Query test with limit/offset interpolation
Query executed successfully, got 1 items
Approve blur request for ID: 86
Request body: {
  blur_settings: {
    strength: 7,
    opacity: 0.1,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 7,
    "opacity": 0.1,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 7,
  opacity: 0.1,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 7,
  opacity: 0.1,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753639206538_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753639986936_1753639206538_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1023, y=1401, w=653, h=729
  Raw coords: x=1401, y=532, w=729, h=653
Final blur coordinates for processing: 1401,532 729x653
Composite will use admin coordinates after rotation: 1023,1401
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753639986936_1753639206538_20250622_003419_debug_breast.jpg
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 7px blur...
DEBUG: Saved blurred region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753639986936_1753639206538_20250622_003419_debug_blur_breast.jpg
Extracted from RAW image at: 1401,532 729x653
Applied blur radius: 7px (7px setting)
Applied white overlay with 10% opacity (enhanced from 10%)
Preparing for composite at: 1023,1401
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753639986936_1753639206538_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753639206538_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753639206538_20250622_003419.jpg
Updating content_moderation record with ID: 88
Blur settings JSON: {"strength":7,"opacity":0.1,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 88
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 0 items
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753640401104-286834449.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 90
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Query test with limit/offset interpolation
Query executed successfully, got 1 items
Approve blur request for ID: 88
Request body: {
  blur_settings: {
    strength: 7,
    opacity: 0.1,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 7,
    "opacity": 0.1,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 7,
  opacity: 0.1,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 7,
  opacity: 0.1,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753640401112_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753640456603_1753640401112_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1023, y=1401, w=653, h=729
  Raw coords: x=1401, y=532, w=729, h=653
Final blur coordinates for processing: 1401,532 729x653
Composite will use admin coordinates after rotation: 1023,1401
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753640456603_1753640401112_20250622_003419_debug_breast.jpg
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 7px blur...
DEBUG: Saved blurred region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753640456603_1753640401112_20250622_003419_debug_blur_breast.jpg
Extracted from RAW image at: 1401,532 729x653
Applied blur radius: 7px (7px setting)
Applied white overlay with 10% opacity (enhanced from 10%)
Preparing for composite at: 1023,1401
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753640456603_1753640401112_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753640401112_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753640401112_20250622_003419.jpg
Updating content_moderation record with ID: 90
Blur settings JSON: {"strength":7,"opacity":0.1,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 90
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 0 items
Copying file to EC2...
Local file: /Users/programmer/Projects/musenest/public/uploads/temp/file-1753640666389-994896479.jpg
Remote file: /tmp/upload_1753640666395_20250622_003419.jpg
SCP exit code: 0
File copied, analyzing...
SSH exit code: 0
Analysis output: {"result":{"confidence_score":0.9,"context_type":"public_gallery","detected_parts":{"breast":82.45043158531189},"explicit_pose_score":65.0,"generated_caption":"Topless adult content with full breast exposure","human_review_required":false,"image_path":"/tmp/upload_1753640666395_20250622_003419.jpg","model_id":1,"moderation_status":"rejected","nudity_score":87.13341951370239,"part_locations":{"breast":{"confidence":82.45,"height":730,"width":654,"x":1024,"y":1401}},"policy_violations":[],"pose_classification":"explicit-topless"},"success":true}

Analysis complete: {
  result: {
    confidence_score: 0.9,
    context_type: 'public_gallery',
    detected_parts: { breast: 82.45043158531189 },
    explicit_pose_score: 65,
    generated_caption: 'Topless adult content with full breast exposure',
    human_review_required: false,
    image_path: '/tmp/upload_1753640666395_20250622_003419.jpg',
    model_id: 1,
    moderation_status: 'rejected',
    nudity_score: 87.13341951370239,
    part_locations: { breast: [Object] },
    policy_violations: [],
    pose_classification: 'explicit-topless'
  },
  success: true
}
Query test with limit/offset interpolation
Query executed successfully, got 0 items
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753640702768-30169808.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error processing uploaded image: Error: Failed to copy file to EC2 for analysis
    at ChildProcess.<anonymous> (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:213:35)
    at ChildProcess.emit (node:events:518:28)
    at maybeClose (node:internal/child_process:1101:16)
    at Socket.<anonymous> (node:internal/child_process:456:11)
    at Socket.emit (node:events:518:28)
    at Pipe.<anonymous> (node:net:346:12)
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753640710876-933489572.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 91
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Impersonation middleware called for: /api/auth/me
Query test with limit/offset interpolation
Query executed successfully, got 1 items
Approve blur request for ID: 89
Request body: {
  blur_settings: {
    strength: 8,
    opacity: 0.1,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 8,
    "opacity": 0.1,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 8,
  opacity: 0.1,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 8,
  opacity: 0.1,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753640710881_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753640730653_1753640710881_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1023, y=1401, w=653, h=729
  Raw coords: x=1401, y=532, w=729, h=653
Final blur coordinates for processing: 1401,532 729x653
Composite will use admin coordinates after rotation: 1023,1401
DEBUG: Saved extracted region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753640730653_1753640710881_20250622_003419_debug_breast.jpg
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 8px blur...
DEBUG: Saved blurred region to /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753640730653_1753640710881_20250622_003419_debug_blur_breast.jpg
Extracted from RAW image at: 1401,532 729x653
Applied blur radius: 8px (8px setting)
Applied white overlay with 10% opacity (enhanced from 10%)
Preparing for composite at: 1023,1401
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753640730653_1753640710881_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753640710881_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753640710881_20250622_003419.jpg
Updating content_moderation record with ID: 91
Blur settings JSON: {"strength":8,"opacity":0.1,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 91
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 0 items
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753640768116-162716717.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 92
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Query test with limit/offset interpolation
Query executed successfully, got 1 items
Approve blur request for ID: 90
Request body: {
  blur_settings: {
    strength: 8,
    opacity: 0.2,
    shape: 'oval',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 8,
    "opacity": 0.2,
    "shape": "oval",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1436,
        "y": 1777,
        "width": 175,
        "height": 235,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 8,
  opacity: 0.2,
  shape: 'oval',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1436,
      y: 1777,
      width: 175,
      height: 235,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 8,
  opacity: 0.2,
  shape: 'oval',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1436,
      y: 1777,
      width: 175,
      height: 235,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753640768124_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753641028644_1753640768124_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1436,
  y: 1777,
  width: 175,
  height: 235,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1436,
  y: 1777,
  width: 175,
  height: 235,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1436, y=1777, w=175, h=235
  Raw coords: x=1777, y=597, w=235, h=175
Final blur coordinates for processing: 1777,597 235x175
Composite will use admin coordinates after rotation: 1436,1777
DEBUG: Would extract region at 1777,597 235x175
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 8px blur...
DEBUG: Applied 8px blur to breast region
Extracted from RAW image at: 1777,597 235x175
Applied blur radius: 8px (8px setting)
Applied white overlay with 20% opacity (enhanced from 20%)
Preparing for composite at: 1436,1777
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753641028644_1753640768124_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753640768124_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753640768124_20250622_003419.jpg
Updating content_moderation record with ID: 92
Blur settings JSON: {"strength":8,"opacity":0.2,"shape":"oval","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1436,"y":1777,"width":175,"height":235,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 92
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 0 items
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753641131488-198934503.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 93
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753641135433-989257140.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 94
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753641138467-828228725.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 95
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753641141544-45257227.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 96
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753641145627-610849293.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 97
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753641149111-719492577.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 98
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753641152493-123470692.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 99
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Impersonation middleware called for: /api/auth/me
Query test with limit/offset interpolation
Query executed successfully, got 7 items
Approve blur request for ID: 97
Request body: {
  blur_settings: {
    strength: 13,
    opacity: 0.1,
    shape: 'oval',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 13,
    "opacity": 0.1,
    "shape": "oval",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1385,
        "y": 1692,
        "width": 263,
        "height": 294,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 13,
  opacity: 0.1,
  shape: 'oval',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1385,
      y: 1692,
      width: 263,
      height: 294,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 13,
  opacity: 0.1,
  shape: 'oval',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1385,
      y: 1692,
      width: 263,
      height: 294,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753641152498_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753641209770_1753641152498_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1385,
  y: 1692,
  width: 263,
  height: 294,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1385,
  y: 1692,
  width: 263,
  height: 294,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1385, y=1692, w=263, h=294
  Raw coords: x=1692, y=560, w=294, h=263
Final blur coordinates for processing: 1692,560 294x263
Composite will use admin coordinates after rotation: 1385,1692
DEBUG: Would extract region at 1692,560 294x263
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 13px blur...
DEBUG: Applied 13px blur to breast region
Extracted from RAW image at: 1692,560 294x263
Applied blur radius: 13px (13px setting)
Applied white overlay with 10% opacity (enhanced from 10%)
Preparing for composite at: 1385,1692
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753641209770_1753641152498_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753641152498_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753641152498_20250622_003419.jpg
Updating content_moderation record with ID: 99
Blur settings JSON: {"strength":13,"opacity":0.1,"shape":"oval","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1385,"y":1692,"width":263,"height":294,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 99
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 6 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Impersonation middleware called for: /api/auth/me
Query test with limit/offset interpolation
Query executed successfully, got 6 items
Approve blur request for ID: 96
Request body: {
  blur_settings: {
    strength: 15,
    opacity: 0.3,
    shape: 'oval',
    blurredParts: [ 'breast', 'custom_1753641400656' ],
    overlayPositions: { breast: [Object], custom_1753641400656: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 15,
    "opacity": 0.3,
    "shape": "oval",
    "blurredParts": [
      "breast",
      "custom_1753641400656"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1484,
        "y": 1851,
        "width": 124,
        "height": 133,
        "confidence": 82.45043158531189
      },
      "custom_1753641400656": {
        "x": 585,
        "y": 2111,
        "width": 147,
        "height": 175,
        "confidence": 100
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 15,
  opacity: 0.3,
  shape: 'oval',
  blurredParts: [ 'breast', 'custom_1753641400656' ],
  overlayPositions: {
    breast: {
      x: 1484,
      y: 1851,
      width: 124,
      height: 133,
      confidence: 82.45043158531189
    },
    custom_1753641400656: { x: 585, y: 2111, width: 147, height: 175, confidence: 100 }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 15,
  opacity: 0.3,
  shape: 'oval',
  blurredParts: [ 'breast', 'custom_1753641400656' ],
  overlayPositions: {
    breast: {
      x: 1484,
      y: 1851,
      width: 124,
      height: 133,
      confidence: 82.45043158531189
    },
    custom_1753641400656: { x: 585, y: 2111, width: 147, height: 175, confidence: 100 }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753641149115_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753641442918_1753641149115_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1484,
  y: 1851,
  width: 124,
  height: 133,
  confidence: 82.45043158531189
}
custom_1753641400656 coordinates from admin interface: { x: 585, y: 2111, width: 147, height: 175, confidence: 100 }
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast', 'custom_1753641400656' ]
Processing blur for breast (received coords): {
  x: 1484,
  y: 1851,
  width: 124,
  height: 133,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1484, y=1851, w=124, h=133
  Raw coords: x=1851, y=600, w=133, h=124
Final blur coordinates for processing: 1851,600 133x124
Composite will use admin coordinates after rotation: 1484,1851
DEBUG: Would extract region at 1851,600 133x124
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 15px blur...
Applying oval mask to blur region
DEBUG: Applied 15px blur to breast region
Extracted from RAW image at: 1851,600 133x124
Applied blur radius: 15px (15px setting)
Applied white overlay with 30% opacity (enhanced from 30%)
Preparing for composite at: 1484,1851
Processing blur for custom_1753641400656 (received coords): { x: 585, y: 2111, width: 147, height: 175, confidence: 100 }
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=585, y=2111, w=147, h=175
  Raw coords: x=2111, y=1476, w=175, h=147
Final blur coordinates for processing: 2111,1476 175x147
Composite will use admin coordinates after rotation: 585,2111
DEBUG: Would extract region at 2111,1476 175x147
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 15px blur...
Applying oval mask to blur region
DEBUG: Applied 15px blur to custom_1753641400656 region
Extracted from RAW image at: 2111,1476 175x147
Applied blur radius: 15px (15px setting)
Applied white overlay with 30% opacity (enhanced from 30%)
Preparing for composite at: 585,2111
Applying 2 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753641442918_1753641149115_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753641149115_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753641149115_20250622_003419.jpg
Updating content_moderation record with ID: 98
Blur settings JSON: {"strength":15,"opacity":0.3,"shape":"oval","blurredParts":["breast","custom_1753641400656"],"overlayPositions":{"breast":{"x":1484,"y":1851,"width":124,"height":133,"confidence":82.45043158531189},"custom_1753641400656":{"x":585,"y":2111,"width":147,"height":175,"confidence":100}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 98
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 5 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Query test with limit/offset interpolation
Query executed successfully, got 20 items
Query test with limit/offset interpolation
Query executed successfully, got 5 items
Approve blur request for ID: 95
Request body: {
  blur_settings: {
    strength: 15,
    opacity: 0.4,
    shape: 'oval',
    blurredParts: [ 'breast', 'custom_1753641548840' ],
    overlayPositions: { breast: [Object], custom_1753641548840: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 15,
    "opacity": 0.4,
    "shape": "oval",
    "blurredParts": [
      "breast",
      "custom_1753641548840"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1490,
        "y": 1851,
        "width": 119,
        "height": 127,
        "confidence": 82.45043158531189
      },
      "custom_1753641548840": {
        "x": 591,
        "y": 2144,
        "width": 127,
        "height": 124,
        "confidence": 100
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 15,
  opacity: 0.4,
  shape: 'oval',
  blurredParts: [ 'breast', 'custom_1753641548840' ],
  overlayPositions: {
    breast: {
      x: 1490,
      y: 1851,
      width: 119,
      height: 127,
      confidence: 82.45043158531189
    },
    custom_1753641548840: { x: 591, y: 2144, width: 127, height: 124, confidence: 100 }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 15,
  opacity: 0.4,
  shape: 'oval',
  blurredParts: [ 'breast', 'custom_1753641548840' ],
  overlayPositions: {
    breast: {
      x: 1490,
      y: 1851,
      width: 119,
      height: 127,
      confidence: 82.45043158531189
    },
    custom_1753641548840: { x: 591, y: 2144, width: 127, height: 124, confidence: 100 }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753641145631_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753641599346_1753641145631_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1490,
  y: 1851,
  width: 119,
  height: 127,
  confidence: 82.45043158531189
}
custom_1753641548840 coordinates from admin interface: { x: 591, y: 2144, width: 127, height: 124, confidence: 100 }
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast', 'custom_1753641548840' ]
Processing blur for breast (received coords): {
  x: 1490,
  y: 1851,
  width: 119,
  height: 127,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1490, y=1851, w=119, h=127
  Raw coords: x=1851, y=599, w=127, h=119
Final blur coordinates for processing: 1851,599 127x119
Composite will use admin coordinates after rotation: 1490,1851
DEBUG: Would extract region at 1851,599 127x119
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 15px blur...
Applying oval mask to blur region
DEBUG: Applied 15px blur to breast region
Extracted from RAW image at: 1851,599 127x119
Applied blur radius: 15px (15px setting)
Applied white overlay with 40% opacity (enhanced from 40%)
Preparing for composite at: 1490,1851
Processing blur for custom_1753641548840 (received coords): { x: 591, y: 2144, width: 127, height: 124, confidence: 100 }
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=591, y=2144, w=127, h=124
  Raw coords: x=2144, y=1490, w=124, h=127
Final blur coordinates for processing: 2144,1490 124x127
Composite will use admin coordinates after rotation: 591,2144
DEBUG: Would extract region at 2144,1490 124x127
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 15px blur...
Applying oval mask to blur region
DEBUG: Applied 15px blur to custom_1753641548840 region
Extracted from RAW image at: 2144,1490 124x127
Applied blur radius: 15px (15px setting)
Applied white overlay with 40% opacity (enhanced from 40%)
Preparing for composite at: 591,2144
Applying 2 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753641599346_1753641145631_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753641145631_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753641145631_20250622_003419.jpg
Updating content_moderation record with ID: 97
Blur settings JSON: {"strength":15,"opacity":0.4,"shape":"oval","blurredParts":["breast","custom_1753641548840"],"overlayPositions":{"breast":{"x":1490,"y":1851,"width":119,"height":127,"confidence":82.45043158531189},"custom_1753641548840":{"x":591,"y":2144,"width":127,"height":124,"confidence":100}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 97
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 4 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Approve blur request for ID: 94
Request body: {
  blur_settings: {
    strength: 15,
    opacity: 0.2,
    shape: 'oval',
    blurredParts: [ 'breast', 'custom_1753641699977' ],
    overlayPositions: { breast: [Object], custom_1753641699977: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 15,
    "opacity": 0.2,
    "shape": "oval",
    "blurredParts": [
      "breast",
      "custom_1753641699977"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1479,
        "y": 1848,
        "width": 130,
        "height": 141,
        "confidence": 82.45043158531189
      },
      "custom_1753641699977": {
        "x": 577,
        "y": 2142,
        "width": 155,
        "height": 136,
        "confidence": 100
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 15,
  opacity: 0.2,
  shape: 'oval',
  blurredParts: [ 'breast', 'custom_1753641699977' ],
  overlayPositions: {
    breast: {
      x: 1479,
      y: 1848,
      width: 130,
      height: 141,
      confidence: 82.45043158531189
    },
    custom_1753641699977: { x: 577, y: 2142, width: 155, height: 136, confidence: 100 }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
Creating blurred version with settings: {
  strength: 15,
  opacity: 0.2,
  shape: 'oval',
  blurredParts: [ 'breast', 'custom_1753641699977' ],
  overlayPositions: {
    breast: {
      x: 1479,
      y: 1848,
      width: 130,
      height: 141,
      confidence: 82.45043158531189
    },
    custom_1753641699977: { x: 577, y: 2142, width: 155, height: 136, confidence: 100 }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753641141549_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753641742633_1753641141549_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1479,
  y: 1848,
  width: 130,
  height: 141,
  confidence: 82.45043158531189
}
custom_1753641699977 coordinates from admin interface: { x: 577, y: 2142, width: 155, height: 136, confidence: 100 }
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast', 'custom_1753641699977' ]
Processing blur for breast (received coords): {
  x: 1479,
  y: 1848,
  width: 130,
  height: 141,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1479, y=1848, w=130, h=141
  Raw coords: x=1848, y=599, w=141, h=130
Final blur coordinates for processing: 1848,599 141x130
Composite will use admin coordinates after rotation: 1479,1848
DEBUG: Would extract region at 1848,599 141x130
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 15px blur...
Blur shape setting received: oval
Applying oval mask to blur region
Region dimensions for mask: 130x141
Creating oval mask: center(65,70.5) radius(63,68.5)
Successfully applied oval mask to blurred region
DEBUG: Applied 15px blur to breast region
Extracted from RAW image at: 1848,599 141x130
Applied blur radius: 15px (15px setting)
Applied white overlay with 20% opacity (enhanced from 20%)
Preparing for composite at: 1479,1848
Processing blur for custom_1753641699977 (received coords): { x: 577, y: 2142, width: 155, height: 136, confidence: 100 }
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=577, y=2142, w=155, h=136
  Raw coords: x=2142, y=1476, w=136, h=155
Final blur coordinates for processing: 2142,1476 136x155
Composite will use admin coordinates after rotation: 577,2142
DEBUG: Would extract region at 2142,1476 136x155
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 15px blur...
Blur shape setting received: oval
Applying oval mask to blur region
Region dimensions for mask: 155x136
Creating oval mask: center(77.5,68) radius(75.5,66)
Successfully applied oval mask to blurred region
DEBUG: Applied 15px blur to custom_1753641699977 region
Extracted from RAW image at: 2142,1476 136x155
Applied blur radius: 15px (15px setting)
Applied white overlay with 20% opacity (enhanced from 20%)
Preparing for composite at: 577,2142
Applying 2 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753641742633_1753641141549_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753641141549_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753641141549_20250622_003419.jpg
Updating content_moderation record with ID: 96
Blur settings JSON: {"strength":15,"opacity":0.2,"shape":"oval","blurredParts":["breast","custom_1753641699977"],"overlayPositions":{"breast":{"x":1479,"y":1848,"width":130,"height":141,"confidence":82.45043158531189},"custom_1753641699977":{"x":577,"y":2142,"width":155,"height":136,"confidence":100}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 96
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 3 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Impersonation middleware called for: /api/auth/me
Query test with limit/offset interpolation
Query executed successfully, got 3 items
Approve blur request for ID: 93
Request body: {
  blur_settings: {
    strength: 15,
    opacity: 0.8,
    shape: 'oval',
    blurredParts: [ 'breast', 'custom_1753641958545' ],
    overlayPositions: { breast: [Object], custom_1753641958545: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 15,
    "opacity": 0.8,
    "shape": "oval",
    "blurredParts": [
      "breast",
      "custom_1753641958545"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      },
      "custom_1753641958545": {
        "x": 599,
        "y": 2159,
        "width": 99,
        "height": 99,
        "confidence": 100
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'oval',
  blurredParts: [ 'breast', 'custom_1753641958545' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    },
    custom_1753641958545: { x: 599, y: 2159, width: 99, height: 99, confidence: 100 }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
SHAPE DEBUG: blur_settings.shape = oval
SHAPE DEBUG: overlayPositions = {
  breast: {
    x: 1023,
    y: 1401,
    width: 653,
    height: 729,
    confidence: 82.45043158531189
  },
  custom_1753641958545: { x: 599, y: 2159, width: 99, height: 99, confidence: 100 }
}
Creating blurred version with settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'oval',
  blurredParts: [ 'breast', 'custom_1753641958545' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    },
    custom_1753641958545: { x: 599, y: 2159, width: 99, height: 99, confidence: 100 }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753641138472_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753641978278_1753641138472_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
custom_1753641958545 coordinates from admin interface: { x: 599, y: 2159, width: 99, height: 99, confidence: 100 }
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast', 'custom_1753641958545' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1023, y=1401, w=653, h=729
  Raw coords: x=1401, y=532, w=729, h=653
Final blur coordinates for processing: 1401,532 729x653
Composite will use admin coordinates after rotation: 1023,1401
DEBUG: Would extract region at 1401,532 729x653
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 15px blur...
Blur shape setting received: oval
FORCE OVAL DEBUG: Using shape = oval (original was oval)
Applying oval mask to blur region
Region dimensions for mask: 653x729
Creating oval mask: center(326.5,364.5) radius(324.5,362.5)
Successfully applied oval mask to blurred region
DEBUG: Applied 15px blur to breast region
Extracted from RAW image at: 1401,532 729x653
Applied blur radius: 15px (15px setting)
Applied white overlay with 80% opacity (enhanced from 80%)
Preparing for composite at: 1023,1401
Processing blur for custom_1753641958545 (received coords): { x: 599, y: 2159, width: 99, height: 99, confidence: 100 }
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=599, y=2159, w=99, h=99
  Raw coords: x=2159, y=1510, w=99, h=99
Final blur coordinates for processing: 2159,1510 99x99
Composite will use admin coordinates after rotation: 599,2159
DEBUG: Would extract region at 2159,1510 99x99
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 15px blur...
Blur shape setting received: oval
FORCE OVAL DEBUG: Using shape = oval (original was oval)
Applying oval mask to blur region
Region dimensions for mask: 99x99
Creating oval mask: center(49.5,49.5) radius(47.5,47.5)
Successfully applied oval mask to blurred region
DEBUG: Applied 15px blur to custom_1753641958545 region
Extracted from RAW image at: 2159,1510 99x99
Applied blur radius: 15px (15px setting)
Applied white overlay with 80% opacity (enhanced from 80%)
Preparing for composite at: 599,2159
Applying 2 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Blurred image created successfully: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753641978278_1753641138472_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753641138472_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753641138472_20250622_003419.jpg
Updating content_moderation record with ID: 95
Blur settings JSON: {"strength":15,"opacity":0.8,"shape":"oval","blurredParts":["breast","custom_1753641958545"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189},"custom_1753641958545":{"x":599,"y":2159,"width":99,"height":99,"confidence":100}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 95
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 2 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Approve blur request for ID: 92
Request body: {
  blur_settings: {
    strength: 15,
    opacity: 0.8,
    shape: 'oval',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 15,
    "opacity": 0.8,
    "shape": "oval",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'oval',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
SHAPE DEBUG: blur_settings.shape = oval
SHAPE DEBUG: overlayPositions = {
  breast: {
    x: 1023,
    y: 1401,
    width: 653,
    height: 729,
    confidence: 82.45043158531189
  }
}
Creating blurred version with settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'oval',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753641135438_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753642087377_1753641135438_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1023, y=1401, w=653, h=729
  Raw coords: x=1401, y=532, w=729, h=653
Final blur coordinates for processing: 1401,532 729x653
Composite will use admin coordinates after rotation: 1023,1401
DEBUG: Would extract region at 1401,532 729x653
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 15px blur...
Blur shape setting received: oval
FORCE OVAL DEBUG: Using shape = oval (original was oval)
Applying oval mask to blur region
Region dimensions for mask: 653x729
ATTEMPTING OVAL MASK CREATION
Creating simple circular mask for 653x729 region
Resizing blur region to circular dimensions: 649x649
OVAL MASK APPLIED - region should now be circular
DEBUG: Applied 15px blur to breast region
Error creating blurred version: [Error: Image to composite must have same dimensions or smaller]
Error stack: Error: Image to composite must have same dimensions or smaller
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753641135438_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753641135438_20250622_003419.jpg
Updating content_moderation record with ID: 94
Blur settings JSON: {"strength":15,"opacity":0.8,"shape":"oval","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 94
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 1 items
Approve blur request for ID: 91
Request body: {
  blur_settings: {
    strength: 15,
    opacity: 0.8,
    shape: 'oval',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 15,
    "opacity": 0.8,
    "shape": "oval",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'oval',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
SHAPE DEBUG: blur_settings.shape = oval
SHAPE DEBUG: overlayPositions = {
  breast: {
    x: 1023,
    y: 1401,
    width: 653,
    height: 729,
    confidence: 82.45043158531189
  }
}
Creating blurred version with settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'oval',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753641131496_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753642124136_1753641131496_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1023, y=1401, w=653, h=729
  Raw coords: x=1401, y=532, w=729, h=653
Final blur coordinates for processing: 1401,532 729x653
Composite will use admin coordinates after rotation: 1023,1401
DEBUG: Would extract region at 1401,532 729x653
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 15px blur...
Blur shape setting received: oval
FORCE OVAL DEBUG: Using shape = oval (original was oval)
Applying oval mask to blur region
Region dimensions for mask: 653x729
ATTEMPTING OVAL MASK CREATION
Creating simple circular mask for 653x729 region
Resizing blur region to circular dimensions: 649x649
OVAL MASK APPLIED - region should now be circular
DEBUG: Applied 15px blur to breast region
Error creating blurred version: [Error: Image to composite must have same dimensions or smaller]
Error stack: Error: Image to composite must have same dimensions or smaller
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753641131496_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753641131496_20250622_003419.jpg
Updating content_moderation record with ID: 93
Blur settings JSON: {"strength":15,"opacity":0.8,"shape":"oval","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 93
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 0 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753642196432-447536431.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 100
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753642200234-600353583.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753642204460-177619343.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 101
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753642209481-233901404.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 102
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753642213068-642851436.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error processing uploaded image: Error: Failed to copy file to EC2 for analysis
    at ChildProcess.<anonymous> (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:213:35)
    at ChildProcess.emit (node:events:518:28)
    at maybeClose (node:internal/child_process:1101:16)
    at Socket.<anonymous> (node:internal/child_process:456:11)
    at Socket.emit (node:events:518:28)
    at Pipe.<anonymous> (node:net:346:12)
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753642217033-337311838.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 103
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753642221251-253688895.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 104
Query test with limit/offset interpolation
Query executed successfully, got 20 items
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Query test with limit/offset interpolation
Query executed successfully, got 5 items
Approve blur request for ID: 102
Request body: {
  blur_settings: {
    strength: 15,
    opacity: 0.8,
    shape: 'oval',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 15,
    "opacity": 0.8,
    "shape": "oval",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1023,
        "y": 1401,
        "width": 653,
        "height": 729,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'oval',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
SHAPE DEBUG: blur_settings.shape = oval
SHAPE DEBUG: overlayPositions = {
  breast: {
    x: 1023,
    y: 1401,
    width: 653,
    height: 729,
    confidence: 82.45043158531189
  }
}
Starting blur processing...
Creating blurred version with settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'oval',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1023,
      y: 1401,
      width: 653,
      height: 729,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753642221255_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753642257859_1753642221255_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1023,
  y: 1401,
  width: 653,
  height: 729,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1023, y=1401, w=653, h=729
  Raw coords: x=1401, y=532, w=729, h=653
Final blur coordinates for processing: 1401,532 729x653
Composite will use admin coordinates after rotation: 1023,1401
DEBUG: Would extract region at 1401,532 729x653
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 15px blur...
Blur shape setting received: oval
DEBUG: Using shape = oval (original was oval)
Applying oval mask to blur region
Region dimensions for mask: 653x729
ATTEMPTING OVAL MASK CREATION
Creating simple circular mask for 653x729 region
Resizing blur region to circular dimensions: 649x649
OVAL MASK APPLIED - region should now be circular
DEBUG: Applied 15px blur to breast region
Error creating blurred version: [Error: Image to composite must have same dimensions or smaller]
Error stack: Error: Image to composite must have same dimensions or smaller
Blur processing completed, path: null
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753642221255_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753642221255_20250622_003419.jpg
Updating content_moderation record with ID: 104
Blur settings JSON: {"strength":15,"opacity":0.8,"shape":"oval","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1023,"y":1401,"width":653,"height":729,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 104
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 4 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
node:events:496
      throw er; // Unhandled 'error' event
      ^

Error: listen EADDRINUSE: address already in use :::3000
    at Server.setupListenHandle [as _listen2] (node:net:1940:16)
    at listenInCluster (node:net:1997:12)
    at Server.listen (node:net:2102:7)
    at Function.listen (/Users/programmer/Projects/musenest/node_modules/express/lib/application.js:635:24)
    at startServer (/Users/programmer/Projects/musenest/server.js:198:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Emitted 'error' event on Server instance at:
    at emitErrorNT (node:net:1976:8)
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '::',
  port: 3000
}

Node.js v22.17.0
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
node:events:496
      throw er; // Unhandled 'error' event
      ^

Error: listen EADDRINUSE: address already in use :::3000
    at Server.setupListenHandle [as _listen2] (node:net:1940:16)
    at listenInCluster (node:net:1997:12)
    at Server.listen (node:net:2102:7)
    at Function.listen (/Users/programmer/Projects/musenest/node_modules/express/lib/application.js:635:24)
    at startServer (/Users/programmer/Projects/musenest/server.js:198:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Emitted 'error' event on Server instance at:
    at emitErrorNT (node:net:1976:8)
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '::',
  port: 3000
}

Node.js v22.17.0
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
node:events:496
      throw er; // Unhandled 'error' event
      ^

Error: listen EADDRINUSE: address already in use :::3000
    at Server.setupListenHandle [as _listen2] (node:net:1940:16)
    at listenInCluster (node:net:1997:12)
    at Server.listen (node:net:2102:7)
    at Function.listen (/Users/programmer/Projects/musenest/node_modules/express/lib/application.js:635:24)
    at startServer (/Users/programmer/Projects/musenest/server.js:198:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Emitted 'error' event on Server instance at:
    at emitErrorNT (node:net:1976:8)
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '::',
  port: 3000
}

Node.js v22.17.0
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
node:events:496
      throw er; // Unhandled 'error' event
      ^

Error: listen EADDRINUSE: address already in use :::3000
    at Server.setupListenHandle [as _listen2] (node:net:1940:16)
    at listenInCluster (node:net:1997:12)
    at Server.listen (node:net:2102:7)
    at Function.listen (/Users/programmer/Projects/musenest/node_modules/express/lib/application.js:635:24)
    at startServer (/Users/programmer/Projects/musenest/server.js:198:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Emitted 'error' event on Server instance at:
    at emitErrorNT (node:net:1976:8)
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '::',
  port: 3000
}

Node.js v22.17.0
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
node:events:496
      throw er; // Unhandled 'error' event
      ^

Error: listen EADDRINUSE: address already in use :::3000
    at Server.setupListenHandle [as _listen2] (node:net:1940:16)
    at listenInCluster (node:net:1997:12)
    at Server.listen (node:net:2102:7)
    at Function.listen (/Users/programmer/Projects/musenest/node_modules/express/lib/application.js:635:24)
    at startServer (/Users/programmer/Projects/musenest/server.js:198:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Emitted 'error' event on Server instance at:
    at emitErrorNT (node:net:1976:8)
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '::',
  port: 3000
}

Node.js v22.17.0
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
node:events:496
      throw er; // Unhandled 'error' event
      ^

Error: listen EADDRINUSE: address already in use :::3000
    at Server.setupListenHandle [as _listen2] (node:net:1940:16)
    at listenInCluster (node:net:1997:12)
    at Server.listen (node:net:2102:7)
    at Function.listen (/Users/programmer/Projects/musenest/node_modules/express/lib/application.js:635:24)
    at startServer (/Users/programmer/Projects/musenest/server.js:198:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Emitted 'error' event on Server instance at:
    at emitErrorNT (node:net:1976:8)
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '::',
  port: 3000
}

Node.js v22.17.0
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
node:events:496
      throw er; // Unhandled 'error' event
      ^

Error: listen EADDRINUSE: address already in use :::3000
    at Server.setupListenHandle [as _listen2] (node:net:1940:16)
    at listenInCluster (node:net:1997:12)
    at Server.listen (node:net:2102:7)
    at Function.listen (/Users/programmer/Projects/musenest/node_modules/express/lib/application.js:635:24)
    at startServer (/Users/programmer/Projects/musenest/server.js:198:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Emitted 'error' event on Server instance at:
    at emitErrorNT (node:net:1976:8)
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '::',
  port: 3000
}

Node.js v22.17.0
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
node:events:496
      throw er; // Unhandled 'error' event
      ^

Error: listen EADDRINUSE: address already in use :::3000
    at Server.setupListenHandle [as _listen2] (node:net:1940:16)
    at listenInCluster (node:net:1997:12)
    at Server.listen (node:net:2102:7)
    at Function.listen (/Users/programmer/Projects/musenest/node_modules/express/lib/application.js:635:24)
    at startServer (/Users/programmer/Projects/musenest/server.js:198:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Emitted 'error' event on Server instance at:
    at emitErrorNT (node:net:1976:8)
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '::',
  port: 3000
}

Node.js v22.17.0
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
(node:78795) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 exit listeners added to [Bus]. MaxListeners is 10. Use emitter.setMaxListeners() to increase limit
(Use `node --trace-warnings ...` to show where the warning was created)
🔍 Testing database connection...
✅ Database connected successfully
node:events:496
      throw er; // Unhandled 'error' event
      ^

Error: listen EADDRINUSE: address already in use :::3000
    at Server.setupListenHandle [as _listen2] (node:net:1940:16)
    at listenInCluster (node:net:1997:12)
    at Server.listen (node:net:2102:7)
    at Function.listen (/Users/programmer/Projects/musenest/node_modules/express/lib/application.js:635:24)
    at startServer (/Users/programmer/Projects/musenest/server.js:198:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Emitted 'error' event on Server instance at:
    at emitErrorNT (node:net:1976:8)
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '::',
  port: 3000
}

Node.js v22.17.0
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
/Users/programmer/Projects/musenest/routes/api/media-review-queue.js:364
        const fs = require('fs');
              ^

SyntaxError: Identifier 'fs' has already been declared
    at wrapSafe (node:internal/modules/cjs/loader:1662:18)
    at Module._compile (node:internal/modules/cjs/loader:1704:20)
    at Object..js (node:internal/modules/cjs/loader:1895:10)
    at Module.load (node:internal/modules/cjs/loader:1465:32)
    at Function._load (node:internal/modules/cjs/loader:1282:12)
    at TracingChannel.traceSync (node:diagnostics_channel:322:14)
    at wrapModuleLoad (node:internal/modules/cjs/loader:235:24)
    at Module.require (node:internal/modules/cjs/loader:1487:12)
    at require (node:internal/modules/helpers:135:16)
    at Object.<anonymous> (/Users/programmer/Projects/musenest/server.js:156:36)

Node.js v22.17.0
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
/Users/programmer/Projects/musenest/routes/api/media-review-queue.js:12
const fs = require('fs').promises;
      ^

SyntaxError: Identifier 'fs' has already been declared
    at wrapSafe (node:internal/modules/cjs/loader:1662:18)
    at Module._compile (node:internal/modules/cjs/loader:1704:20)
    at Object..js (node:internal/modules/cjs/loader:1895:10)
    at Module.load (node:internal/modules/cjs/loader:1465:32)
    at Function._load (node:internal/modules/cjs/loader:1282:12)
    at TracingChannel.traceSync (node:diagnostics_channel:322:14)
    at wrapModuleLoad (node:internal/modules/cjs/loader:235:24)
    at Module.require (node:internal/modules/cjs/loader:1487:12)
    at require (node:internal/modules/helpers:135:16)
    at Object.<anonymous> (/Users/programmer/Projects/musenest/server.js:156:36)

Node.js v22.17.0
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
/Users/programmer/Projects/musenest/routes/api/media-review-queue.js:368
        const fs = require('fs');
              ^

SyntaxError: Identifier 'fs' has already been declared
    at wrapSafe (node:internal/modules/cjs/loader:1662:18)
    at Module._compile (node:internal/modules/cjs/loader:1704:20)
    at Object..js (node:internal/modules/cjs/loader:1895:10)
    at Module.load (node:internal/modules/cjs/loader:1465:32)
    at Function._load (node:internal/modules/cjs/loader:1282:12)
    at TracingChannel.traceSync (node:diagnostics_channel:322:14)
    at wrapModuleLoad (node:internal/modules/cjs/loader:235:24)
    at Module.require (node:internal/modules/cjs/loader:1487:12)
    at require (node:internal/modules/helpers:135:16)
    at Object.<anonymous> (/Users/programmer/Projects/musenest/server.js:156:36)

Node.js v22.17.0
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
/Users/programmer/Projects/musenest/routes/api/media-review-queue.js:368
        const fs = require('fs');
              ^

SyntaxError: Identifier 'fs' has already been declared
    at wrapSafe (node:internal/modules/cjs/loader:1662:18)
    at Module._compile (node:internal/modules/cjs/loader:1704:20)
    at Object..js (node:internal/modules/cjs/loader:1895:10)
    at Module.load (node:internal/modules/cjs/loader:1465:32)
    at Function._load (node:internal/modules/cjs/loader:1282:12)
    at TracingChannel.traceSync (node:diagnostics_channel:322:14)
    at wrapModuleLoad (node:internal/modules/cjs/loader:235:24)
    at Module.require (node:internal/modules/cjs/loader:1487:12)
    at require (node:internal/modules/helpers:135:16)
    at Object.<anonymous> (/Users/programmer/Projects/musenest/server.js:156:36)

Node.js v22.17.0
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
/Users/programmer/Projects/musenest/routes/api/media-review-queue.js:368
        const fs = require('fs');
              ^

SyntaxError: Identifier 'fs' has already been declared
    at wrapSafe (node:internal/modules/cjs/loader:1662:18)
    at Module._compile (node:internal/modules/cjs/loader:1704:20)
    at Object..js (node:internal/modules/cjs/loader:1895:10)
    at Module.load (node:internal/modules/cjs/loader:1465:32)
    at Function._load (node:internal/modules/cjs/loader:1282:12)
    at TracingChannel.traceSync (node:diagnostics_channel:322:14)
    at wrapModuleLoad (node:internal/modules/cjs/loader:235:24)
    at Module.require (node:internal/modules/cjs/loader:1487:12)
    at require (node:internal/modules/helpers:135:16)
    at Object.<anonymous> (/Users/programmer/Projects/musenest/server.js:156:36)

Node.js v22.17.0
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
/Users/programmer/Projects/musenest/routes/api/media-review-queue.js:368
        const fs = require('fs');
              ^

SyntaxError: Identifier 'fs' has already been declared
    at wrapSafe (node:internal/modules/cjs/loader:1662:18)
    at Module._compile (node:internal/modules/cjs/loader:1704:20)
    at Object..js (node:internal/modules/cjs/loader:1895:10)
    at Module.load (node:internal/modules/cjs/loader:1465:32)
    at Function._load (node:internal/modules/cjs/loader:1282:12)
    at TracingChannel.traceSync (node:diagnostics_channel:322:14)
    at wrapModuleLoad (node:internal/modules/cjs/loader:235:24)
    at Module.require (node:internal/modules/cjs/loader:1487:12)
    at require (node:internal/modules/helpers:135:16)
    at Object.<anonymous> (/Users/programmer/Projects/musenest/server.js:156:36)

Node.js v22.17.0
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
/Users/programmer/Projects/musenest/routes/api/media-review-queue.js:368
        const fs = require('fs');
              ^

SyntaxError: Identifier 'fs' has already been declared
    at wrapSafe (node:internal/modules/cjs/loader:1662:18)
    at Module._compile (node:internal/modules/cjs/loader:1704:20)
    at Object..js (node:internal/modules/cjs/loader:1895:10)
    at Module.load (node:internal/modules/cjs/loader:1465:32)
    at Function._load (node:internal/modules/cjs/loader:1282:12)
    at TracingChannel.traceSync (node:diagnostics_channel:322:14)
    at wrapModuleLoad (node:internal/modules/cjs/loader:235:24)
    at Module.require (node:internal/modules/cjs/loader:1487:12)
    at require (node:internal/modules/helpers:135:16)
    at Object.<anonymous> (/Users/programmer/Projects/musenest/server.js:156:36)

Node.js v22.17.0
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
/Users/programmer/Projects/musenest/routes/api/media-review-queue.js:7
fs.appendFileSync('/tmp/blur_debug.log', `Media review queue API loaded at ${new Date()}\n`);
^

ReferenceError: fs is not defined
    at Object.<anonymous> (/Users/programmer/Projects/musenest/routes/api/media-review-queue.js:7:1)
    at Module._compile (node:internal/modules/cjs/loader:1730:14)
    at Object..js (node:internal/modules/cjs/loader:1895:10)
    at Module.load (node:internal/modules/cjs/loader:1465:32)
    at Function._load (node:internal/modules/cjs/loader:1282:12)
    at TracingChannel.traceSync (node:diagnostics_channel:322:14)
    at wrapModuleLoad (node:internal/modules/cjs/loader:235:24)
    at Module.require (node:internal/modules/cjs/loader:1487:12)
    at require (node:internal/modules/helpers:135:16)
    at Object.<anonymous> (/Users/programmer/Projects/musenest/server.js:156:36)

Node.js v22.17.0
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Approve blur request for ID: 109
Request body: {
  blur_settings: {
    strength: 15,
    opacity: 0.8,
    shape: 'oval',
    blurredParts: [ 'genitalia' ],
    overlayPositions: { genitalia: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 15,
    "opacity": 0.8,
    "shape": "oval",
    "blurredParts": [
      "genitalia"
    ],
    "overlayPositions": {
      "genitalia": {
        "x": 2069,
        "y": 2340,
        "width": 538,
        "height": 645,
        "confidence": 26.578259468078613
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'oval',
  blurredParts: [ 'genitalia' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2340,
      width: 538,
      height: 645,
      confidence: 26.578259468078613
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
=== SHAPE DEBUG START ===
blur_settings received: {
  "strength": 15,
  "opacity": 0.8,
  "shape": "oval",
  "blurredParts": [
    "genitalia"
  ],
  "overlayPositions": {
    "genitalia": {
      "x": 2069,
      "y": 2340,
      "width": 538,
      "height": 645,
      "confidence": 26.578259468078613
    }
  }
}
shape value: oval
shape type: string
=== SHAPE DEBUG END ===
Starting blur processing...
Creating blurred version with settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'oval',
  blurredParts: [ 'genitalia' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2340,
      width: 538,
      height: 645,
      confidence: 26.578259468078613
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753643662706_20230703_111727.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644070302_1753643662706_20230703_111727.jpg
=== COORDINATE DEBUGGING START ===
genitalia coordinates from admin interface: {
  x: 2069,
  y: 2340,
  width: 538,
  height: 645,
  confidence: 26.578259468078613
}
Raw image dimensions: 4000 x 3000 orientation: 1
Auto-rotated image dimensions: 4000 x 3000
Applying selective blur to regions: [ 'genitalia' ]
Processing blur for genitalia (received coords): {
  x: 2069,
  y: 2340,
  width: 538,
  height: 645,
  confidence: 26.578259468078613
}
Auto-rotated image dimensions: 4000x3000
No coordinate transformation needed:
  Direct coords: x=2069, y=2340, w=538, h=645
Final blur coordinates for processing: 2069,2340 538x645
DEBUG: Would extract region at 2069,2340 538x645
Creating blurred region with 15px blur...
Blur shape setting received: 'oval' (type: string)
DEBUG: Using shape = 'oval' (original was 'oval')
TESTING: actualShape='oval', blurShape='oval'
*** OVAL SHAPE DETECTED - APPLYING CIRCULAR MASK ***
Applying oval shape to genitalia blur region
Creating oval mask with radius 267 for 538x645 region
Successfully applied oval mask to genitalia
DEBUG: Applied 15px blur to genitalia region
Extracted from RAW image at: 2069,2340 538x645
Applied blur radius: 15px (15px setting)
Applied white overlay with 80% opacity (enhanced from 80%)
Preparing for composite at: 2069,2340
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Attempting to save processed image to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644070302_1753643662706_20230703_111727.jpg
SUCCESS: Blurred image saved successfully to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644070302_1753643662706_20230703_111727.jpg
File verification - Size: 4168677 bytes
Blur processing completed, path: /uploads/escort-example/public/blurred/blurred_1753644070302_1753643662706_20230703_111727.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753643662706_20230703_111727.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753643662706_20230703_111727.jpg
Updating content_moderation record with ID: 111
Blur settings JSON: {"strength":15,"opacity":0.8,"shape":"oval","blurredParts":["genitalia"],"overlayPositions":{"genitalia":{"x":2069,"y":2340,"width":538,"height":645,"confidence":26.578259468078613}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 111
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 1 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Approve blur request for ID: 107
Request body: {
  blur_settings: {
    strength: 15,
    opacity: 0.8,
    shape: 'rounded',
    blurredParts: [ 'genitalia' ],
    overlayPositions: { genitalia: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 15,
    "opacity": 0.8,
    "shape": "rounded",
    "blurredParts": [
      "genitalia"
    ],
    "overlayPositions": {
      "genitalia": {
        "x": 2069,
        "y": 2340,
        "width": 538,
        "height": 645,
        "confidence": 26.578259468078613
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'rounded',
  blurredParts: [ 'genitalia' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2340,
      width: 538,
      height: 645,
      confidence: 26.578259468078613
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
=== SHAPE DEBUG START ===
blur_settings received: {
  "strength": 15,
  "opacity": 0.8,
  "shape": "rounded",
  "blurredParts": [
    "genitalia"
  ],
  "overlayPositions": {
    "genitalia": {
      "x": 2069,
      "y": 2340,
      "width": 538,
      "height": 645,
      "confidence": 26.578259468078613
    }
  }
}
shape value: rounded
shape type: string
=== SHAPE DEBUG END ===
Starting blur processing...
Creating blurred version with settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'rounded',
  blurredParts: [ 'genitalia' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2340,
      width: 538,
      height: 645,
      confidence: 26.578259468078613
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753643649534_20230703_111727.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644170815_1753643649534_20230703_111727.jpg
=== COORDINATE DEBUGGING START ===
genitalia coordinates from admin interface: {
  x: 2069,
  y: 2340,
  width: 538,
  height: 645,
  confidence: 26.578259468078613
}
Raw image dimensions: 4000 x 3000 orientation: 1
Auto-rotated image dimensions: 4000 x 3000
Applying selective blur to regions: [ 'genitalia' ]
Processing blur for genitalia (received coords): {
  x: 2069,
  y: 2340,
  width: 538,
  height: 645,
  confidence: 26.578259468078613
}
Auto-rotated image dimensions: 4000x3000
No coordinate transformation needed:
  Direct coords: x=2069, y=2340, w=538, h=645
Final blur coordinates for processing: 2069,2340 538x645
DEBUG: Would extract region at 2069,2340 538x645
Creating blurred region with 15px blur...
Blur shape setting received: 'rounded' (type: string)
DEBUG: Using shape = 'rounded' (original was 'rounded')
TESTING: actualShape='rounded', blurShape='rounded'
Using rectangular blur for genitalia (shape: rounded)
DEBUG: Applied 15px blur to genitalia region
Extracted from RAW image at: 2069,2340 538x645
Applied blur radius: 15px (15px setting)
Applied white overlay with 80% opacity (enhanced from 80%)
Preparing for composite at: 2069,2340
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Attempting to save processed image to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644170815_1753643649534_20230703_111727.jpg
SUCCESS: Blurred image saved successfully to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644170815_1753643649534_20230703_111727.jpg
File verification - Size: 4170427 bytes
Blur processing completed, path: /uploads/escort-example/public/blurred/blurred_1753644170815_1753643649534_20230703_111727.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753643649534_20230703_111727.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753643649534_20230703_111727.jpg
Updating content_moderation record with ID: 109
Blur settings JSON: {"strength":15,"opacity":0.8,"shape":"rounded","blurredParts":["genitalia"],"overlayPositions":{"genitalia":{"x":2069,"y":2340,"width":538,"height":645,"confidence":26.578259468078613}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 109
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 0 items
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20230703_111727.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753644175440-998695201.jpg',
  originalName: '20230703_111727.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 112
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20230703_111727.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753644179799-291624488.jpg',
  originalName: '20230703_111727.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 113
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20230703_111727.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753644183732-956930072.jpg',
  originalName: '20230703_111727.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 114
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20230703_111727.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753644187365-927172699.jpg',
  originalName: '20230703_111727.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 115
Query test with limit/offset interpolation
Query executed successfully, got 4 items
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Approve blur request for ID: 113
Request body: {
  blur_settings: {
    strength: 15,
    opacity: 0.8,
    shape: 'oval',
    blurredParts: [ 'genitalia' ],
    overlayPositions: { genitalia: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 15,
    "opacity": 0.8,
    "shape": "oval",
    "blurredParts": [
      "genitalia"
    ],
    "overlayPositions": {
      "genitalia": {
        "x": 2069,
        "y": 2340,
        "width": 538,
        "height": 645,
        "confidence": 26.578259468078613
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'oval',
  blurredParts: [ 'genitalia' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2340,
      width: 538,
      height: 645,
      confidence: 26.578259468078613
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
=== SHAPE DEBUG START ===
blur_settings received: {
  "strength": 15,
  "opacity": 0.8,
  "shape": "oval",
  "blurredParts": [
    "genitalia"
  ],
  "overlayPositions": {
    "genitalia": {
      "x": 2069,
      "y": 2340,
      "width": 538,
      "height": 645,
      "confidence": 26.578259468078613
    }
  }
}
shape value: oval
shape type: string
=== SHAPE DEBUG END ===
Starting blur processing...
Creating blurred version with settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'oval',
  blurredParts: [ 'genitalia' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2340,
      width: 538,
      height: 645,
      confidence: 26.578259468078613
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753644187378_20230703_111727.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644201339_1753644187378_20230703_111727.jpg
=== COORDINATE DEBUGGING START ===
genitalia coordinates from admin interface: {
  x: 2069,
  y: 2340,
  width: 538,
  height: 645,
  confidence: 26.578259468078613
}
Raw image dimensions: 4000 x 3000 orientation: 1
Auto-rotated image dimensions: 4000 x 3000
Applying selective blur to regions: [ 'genitalia' ]
Processing blur for genitalia (received coords): {
  x: 2069,
  y: 2340,
  width: 538,
  height: 645,
  confidence: 26.578259468078613
}
Auto-rotated image dimensions: 4000x3000
No coordinate transformation needed:
  Direct coords: x=2069, y=2340, w=538, h=645
Final blur coordinates for processing: 2069,2340 538x645
DEBUG: Would extract region at 2069,2340 538x645
Creating blurred region with 15px blur...
Blur shape setting received: 'oval' (type: string)
DEBUG: Using shape = 'oval' (original was 'oval')
TESTING: actualShape='oval', blurShape='oval'
*** OVAL SHAPE DETECTED - APPLYING CIRCULAR MASK ***
Applying oval shape to genitalia blur region
Creating oval mask with radius 267 for 538x645 region
Creating circular mask using Sharp roundCorners
Oval mask failed for genitalia: sharp(...).resize(...).roundCorners is not a function
Continuing with rectangular blur for genitalia
DEBUG: Applied 15px blur to genitalia region
Extracted from RAW image at: 2069,2340 538x645
Applied blur radius: 15px (15px setting)
Applied white overlay with 80% opacity (enhanced from 80%)
Preparing for composite at: 2069,2340
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Attempting to save processed image to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644201339_1753644187378_20230703_111727.jpg
SUCCESS: Blurred image saved successfully to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644201339_1753644187378_20230703_111727.jpg
File verification - Size: 4170427 bytes
Blur processing completed, path: /uploads/escort-example/public/blurred/blurred_1753644201339_1753644187378_20230703_111727.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753644187378_20230703_111727.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753644187378_20230703_111727.jpg
Updating content_moderation record with ID: 115
Blur settings JSON: {"strength":15,"opacity":0.8,"shape":"oval","blurredParts":["genitalia"],"overlayPositions":{"genitalia":{"x":2069,"y":2340,"width":538,"height":645,"confidence":26.578259468078613}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 115
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 3 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Approve blur request for ID: 112
Request body: {
  blur_settings: {
    strength: 15,
    opacity: 0.8,
    shape: 'oval',
    blurredParts: [ 'genitalia' ],
    overlayPositions: { genitalia: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 15,
    "opacity": 0.8,
    "shape": "oval",
    "blurredParts": [
      "genitalia"
    ],
    "overlayPositions": {
      "genitalia": {
        "x": 2069,
        "y": 2340,
        "width": 410,
        "height": 230,
        "confidence": 26.578259468078613
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'oval',
  blurredParts: [ 'genitalia' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2340,
      width: 410,
      height: 230,
      confidence: 26.578259468078613
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
=== SHAPE DEBUG START ===
blur_settings received: {
  "strength": 15,
  "opacity": 0.8,
  "shape": "oval",
  "blurredParts": [
    "genitalia"
  ],
  "overlayPositions": {
    "genitalia": {
      "x": 2069,
      "y": 2340,
      "width": 410,
      "height": 230,
      "confidence": 26.578259468078613
    }
  }
}
shape value: oval
shape type: string
=== SHAPE DEBUG END ===
Starting blur processing...
Creating blurred version with settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'oval',
  blurredParts: [ 'genitalia' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2340,
      width: 410,
      height: 230,
      confidence: 26.578259468078613
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753644183748_20230703_111727.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644324803_1753644183748_20230703_111727.jpg
=== COORDINATE DEBUGGING START ===
genitalia coordinates from admin interface: {
  x: 2069,
  y: 2340,
  width: 410,
  height: 230,
  confidence: 26.578259468078613
}
Raw image dimensions: 4000 x 3000 orientation: 1
Auto-rotated image dimensions: 4000 x 3000
Applying selective blur to regions: [ 'genitalia' ]
Processing blur for genitalia (received coords): {
  x: 2069,
  y: 2340,
  width: 410,
  height: 230,
  confidence: 26.578259468078613
}
Auto-rotated image dimensions: 4000x3000
No coordinate transformation needed:
  Direct coords: x=2069, y=2340, w=410, h=230
Final blur coordinates for processing: 2069,2340 410x230
DEBUG: Would extract region at 2069,2340 410x230
Creating blurred region with 15px blur...
Blur shape setting received: 'oval' (type: string)
DEBUG: Using shape = 'oval' (original was 'oval')
TESTING: actualShape='oval', blurShape='oval'
*** OVAL SHAPE DETECTED - APPLYING CIRCULAR MASK ***
Applying oval shape to genitalia blur region
Creating oval mask with radius 113 for 410x230 region
Creating circular mask using Sharp roundCorners
Oval mask failed for genitalia: sharp(...).resize(...).roundCorners is not a function
Continuing with rectangular blur for genitalia
DEBUG: Applied 15px blur to genitalia region
Applying circular shape to white overlay to match blur
Error creating blurred version: TypeError: sharp(...).resize(...).roundCorners is not a function
    at createBlurredVersion (/Users/programmer/Projects/musenest/routes/api/media-review-queue.js:837:26)
    at async /Users/programmer/Projects/musenest/routes/api/media-review-queue.js:371:27
Error stack: TypeError: sharp(...).resize(...).roundCorners is not a function
    at createBlurredVersion (/Users/programmer/Projects/musenest/routes/api/media-review-queue.js:837:26)
    at async /Users/programmer/Projects/musenest/routes/api/media-review-queue.js:371:27
Blur processing completed, path: null
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753644183748_20230703_111727.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753644183748_20230703_111727.jpg
Updating content_moderation record with ID: 114
Blur settings JSON: {"strength":15,"opacity":0.8,"shape":"oval","blurredParts":["genitalia"],"overlayPositions":{"genitalia":{"x":2069,"y":2340,"width":410,"height":230,"confidence":26.578259468078613}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 114
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 2 items
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20230703_111727.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753644395451-167265071.jpg',
  originalName: '20230703_111727.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 116
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20230703_111727.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753644417535-694239360.jpg',
  originalName: '20230703_111727.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 117
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20230703_111727.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753644426272-891759109.jpg',
  originalName: '20230703_111727.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 118
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Approve blur request for ID: 111
Request body: {
  blur_settings: {
    strength: 15,
    opacity: 0.8,
    shape: 'oval',
    blurredParts: [ 'genitalia' ],
    overlayPositions: { genitalia: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 15,
    "opacity": 0.8,
    "shape": "oval",
    "blurredParts": [
      "genitalia"
    ],
    "overlayPositions": {
      "genitalia": {
        "x": 2069,
        "y": 2340,
        "width": 538,
        "height": 282,
        "confidence": 26.578259468078613
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'oval',
  blurredParts: [ 'genitalia' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2340,
      width: 538,
      height: 282,
      confidence: 26.578259468078613
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
=== SHAPE DEBUG START ===
blur_settings received: {
  "strength": 15,
  "opacity": 0.8,
  "shape": "oval",
  "blurredParts": [
    "genitalia"
  ],
  "overlayPositions": {
    "genitalia": {
      "x": 2069,
      "y": 2340,
      "width": 538,
      "height": 282,
      "confidence": 26.578259468078613
    }
  }
}
shape value: oval
shape type: string
=== SHAPE DEBUG END ===
Starting blur processing...
Creating blurred version with settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'oval',
  blurredParts: [ 'genitalia' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2340,
      width: 538,
      height: 282,
      confidence: 26.578259468078613
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753644179813_20230703_111727.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644457107_1753644179813_20230703_111727.jpg
=== COORDINATE DEBUGGING START ===
genitalia coordinates from admin interface: {
  x: 2069,
  y: 2340,
  width: 538,
  height: 282,
  confidence: 26.578259468078613
}
Raw image dimensions: 4000 x 3000 orientation: 1
Auto-rotated image dimensions: 4000 x 3000
Applying selective blur to regions: [ 'genitalia' ]
Processing blur for genitalia (received coords): {
  x: 2069,
  y: 2340,
  width: 538,
  height: 282,
  confidence: 26.578259468078613
}
Auto-rotated image dimensions: 4000x3000
No coordinate transformation needed:
  Direct coords: x=2069, y=2340, w=538, h=282
Final blur coordinates for processing: 2069,2340 538x282
DEBUG: Would extract region at 2069,2340 538x282
Creating blurred region with 15px blur...
Blur shape setting received: 'oval' (type: string)
DEBUG: Using shape = 'oval' (original was 'oval')
TESTING: actualShape='oval', blurShape='oval'
*** OVAL SHAPE DETECTED - APPLYING CIRCULAR MASK ***
Applying oval shape to genitalia blur region
Creating oval mask with radius 139 for 538x282 region
Creating circular mask using Sharp roundCorners
Oval mask failed for genitalia: sharp(...).resize(...).roundCorners is not a function
Continuing with rectangular blur for genitalia
DEBUG: Applied 15px blur to genitalia region
Applying circular shape to white overlay to match blur
White overlay circular processing failed: sharp(...).resize(...).roundCorners is not a function
Extracted from RAW image at: 2069,2340 538x282
Applied blur radius: 15px (15px setting)
Applied white overlay with 80% opacity (enhanced from 80%)
Preparing for composite at: 2069,2340
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Attempting to save processed image to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644457107_1753644179813_20230703_111727.jpg
SUCCESS: Blurred image saved successfully to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644457107_1753644179813_20230703_111727.jpg
File verification - Size: 4199003 bytes
Blur processing completed, path: /uploads/escort-example/public/blurred/blurred_1753644457107_1753644179813_20230703_111727.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753644179813_20230703_111727.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753644179813_20230703_111727.jpg
Updating content_moderation record with ID: 113
Blur settings JSON: {"strength":15,"opacity":0.8,"shape":"oval","blurredParts":["genitalia"],"overlayPositions":{"genitalia":{"x":2069,"y":2340,"width":538,"height":282,"confidence":26.578259468078613}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 113
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 4 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Approve blur request for ID: 116
Request body: {
  blur_settings: {
    strength: 15,
    opacity: 0.8,
    shape: 'oval',
    blurredParts: [ 'genitalia' ],
    overlayPositions: { genitalia: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 15,
    "opacity": 0.8,
    "shape": "oval",
    "blurredParts": [
      "genitalia"
    ],
    "overlayPositions": {
      "genitalia": {
        "x": 2069,
        "y": 2119,
        "width": 538,
        "height": 645,
        "confidence": 26.578259468078613
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'oval',
  blurredParts: [ 'genitalia' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2119,
      width: 538,
      height: 645,
      confidence: 26.578259468078613
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
=== SHAPE DEBUG START ===
blur_settings received: {
  "strength": 15,
  "opacity": 0.8,
  "shape": "oval",
  "blurredParts": [
    "genitalia"
  ],
  "overlayPositions": {
    "genitalia": {
      "x": 2069,
      "y": 2119,
      "width": 538,
      "height": 645,
      "confidence": 26.578259468078613
    }
  }
}
shape value: oval
shape type: string
=== SHAPE DEBUG END ===
Starting blur processing...
Creating blurred version with settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'oval',
  blurredParts: [ 'genitalia' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2119,
      width: 538,
      height: 645,
      confidence: 26.578259468078613
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753644426294_20230703_111727.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644618535_1753644426294_20230703_111727.jpg
=== COORDINATE DEBUGGING START ===
genitalia coordinates from admin interface: {
  x: 2069,
  y: 2119,
  width: 538,
  height: 645,
  confidence: 26.578259468078613
}
Raw image dimensions: 4000 x 3000 orientation: 1
Auto-rotated image dimensions: 4000 x 3000
Applying selective blur to regions: [ 'genitalia' ]
Processing blur for genitalia (received coords): {
  x: 2069,
  y: 2119,
  width: 538,
  height: 645,
  confidence: 26.578259468078613
}
Auto-rotated image dimensions: 4000x3000
No coordinate transformation needed:
  Direct coords: x=2069, y=2119, w=538, h=645
Final blur coordinates for processing: 2069,2119 538x645
DEBUG: Would extract region at 2069,2119 538x645
Creating blurred region with 15px blur...
Blur shape setting received: 'oval' (type: string)
DEBUG: Using shape = 'oval' (original was 'oval')
TESTING: actualShape='oval', blurShape='oval'
*** OVAL SHAPE DETECTED - APPLYING CIRCULAR MASK ***
Applying oval shape to genitalia blur region
Creating oval mask with radius 267 for 538x645 region
Creating circular mask using SVG approach
Applied circular mask using SVG with radius 268
Successfully applied oval mask to genitalia
DEBUG: Applied 15px blur to genitalia region
Applying circular shape to white overlay to match blur
Extracted from RAW image at: 2069,2119 538x645
Applied blur radius: 15px (15px setting)
Applied white overlay with 80% opacity (enhanced from 80%)
Preparing for composite at: 2069,2119
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Attempting to save processed image to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644618535_1753644426294_20230703_111727.jpg
SUCCESS: Blurred image saved successfully to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644618535_1753644426294_20230703_111727.jpg
File verification - Size: 4188929 bytes
Blur processing completed, path: /uploads/escort-example/public/blurred/blurred_1753644618535_1753644426294_20230703_111727.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753644426294_20230703_111727.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753644426294_20230703_111727.jpg
Updating content_moderation record with ID: 118
Blur settings JSON: {"strength":15,"opacity":0.8,"shape":"oval","blurredParts":["genitalia"],"overlayPositions":{"genitalia":{"x":2069,"y":2119,"width":538,"height":645,"confidence":26.578259468078613}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 118
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 3 items
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753644684965-767644056.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 119
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Query test with limit/offset interpolation
Query executed successfully, got 4 items
Approve blur request for ID: 117
Request body: {
  blur_settings: {
    strength: 6,
    opacity: 0.2,
    shape: 'oval',
    blurredParts: [ 'breast', 'custom_1753644695715' ],
    overlayPositions: { breast: [Object], custom_1753644695715: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 6,
    "opacity": 0.2,
    "shape": "oval",
    "blurredParts": [
      "breast",
      "custom_1753644695715"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1431,
        "y": 1831,
        "width": 192,
        "height": 153,
        "confidence": 82.45043158531189
      },
      "custom_1753644695715": {
        "x": 548,
        "y": 2105,
        "width": 181,
        "height": 175,
        "confidence": 100
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 6,
  opacity: 0.2,
  shape: 'oval',
  blurredParts: [ 'breast', 'custom_1753644695715' ],
  overlayPositions: {
    breast: {
      x: 1431,
      y: 1831,
      width: 192,
      height: 153,
      confidence: 82.45043158531189
    },
    custom_1753644695715: { x: 548, y: 2105, width: 181, height: 175, confidence: 100 }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
=== SHAPE DEBUG START ===
blur_settings received: {
  "strength": 6,
  "opacity": 0.2,
  "shape": "oval",
  "blurredParts": [
    "breast",
    "custom_1753644695715"
  ],
  "overlayPositions": {
    "breast": {
      "x": 1431,
      "y": 1831,
      "width": 192,
      "height": 153,
      "confidence": 82.45043158531189
    },
    "custom_1753644695715": {
      "x": 548,
      "y": 2105,
      "width": 181,
      "height": 175,
      "confidence": 100
    }
  }
}
shape value: oval
shape type: string
=== SHAPE DEBUG END ===
Starting blur processing...
Creating blurred version with settings: {
  strength: 6,
  opacity: 0.2,
  shape: 'oval',
  blurredParts: [ 'breast', 'custom_1753644695715' ],
  overlayPositions: {
    breast: {
      x: 1431,
      y: 1831,
      width: 192,
      height: 153,
      confidence: 82.45043158531189
    },
    custom_1753644695715: { x: 548, y: 2105, width: 181, height: 175, confidence: 100 }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753644684976_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644747141_1753644684976_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1431,
  y: 1831,
  width: 192,
  height: 153,
  confidence: 82.45043158531189
}
custom_1753644695715 coordinates from admin interface: { x: 548, y: 2105, width: 181, height: 175, confidence: 100 }
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast', 'custom_1753644695715' ]
Processing blur for breast (received coords): {
  x: 1431,
  y: 1831,
  width: 192,
  height: 153,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1431, y=1831, w=192, h=153
  Raw coords: x=1831, y=585, w=153, h=192
Final blur coordinates for processing: 1831,585 153x192
Composite will use admin coordinates after rotation: 1431,1831
DEBUG: Would extract region at 1831,585 153x192
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 6px blur...
Blur shape setting received: 'oval' (type: string)
DEBUG: Using shape = 'oval' (original was 'oval')
TESTING: actualShape='oval', blurShape='oval'
*** OVAL SHAPE DETECTED - APPLYING CIRCULAR MASK ***
Applying oval shape to breast blur region
Creating oval mask with radius 74 for 192x153 region
Creating circular mask using SVG approach
Applied circular mask using SVG with radius 75.5
Successfully applied oval mask to breast
DEBUG: Applied 6px blur to breast region
Applying circular shape to white overlay to match blur
Extracted from RAW image at: 1831,585 153x192
Applied blur radius: 6px (6px setting)
Applied white overlay with 20% opacity (enhanced from 20%)
Preparing for composite at: 1431,1831
Processing blur for custom_1753644695715 (received coords): { x: 548, y: 2105, width: 181, height: 175, confidence: 100 }
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=548, y=2105, w=181, h=175
  Raw coords: x=2105, y=1479, w=175, h=181
Final blur coordinates for processing: 2105,1479 175x181
Composite will use admin coordinates after rotation: 548,2105
DEBUG: Would extract region at 2105,1479 175x181
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 6px blur...
Blur shape setting received: 'oval' (type: string)
DEBUG: Using shape = 'oval' (original was 'oval')
TESTING: actualShape='oval', blurShape='oval'
*** OVAL SHAPE DETECTED - APPLYING CIRCULAR MASK ***
Applying oval shape to custom_1753644695715 blur region
Creating oval mask with radius 85 for 181x175 region
Creating circular mask using SVG approach
Applied circular mask using SVG with radius 86.5
Successfully applied oval mask to custom_1753644695715
DEBUG: Applied 6px blur to custom_1753644695715 region
Applying circular shape to white overlay to match blur
Extracted from RAW image at: 2105,1479 175x181
Applied blur radius: 6px (6px setting)
Applied white overlay with 20% opacity (enhanced from 20%)
Preparing for composite at: 548,2105
Applying 2 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Attempting to save processed image to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644747141_1753644684976_20250622_003419.jpg
SUCCESS: Blurred image saved successfully to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644747141_1753644684976_20250622_003419.jpg
File verification - Size: 1061871 bytes
Blur processing completed, path: /uploads/escort-example/public/blurred/blurred_1753644747141_1753644684976_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753644684976_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753644684976_20250622_003419.jpg
Updating content_moderation record with ID: 119
Blur settings JSON: {"strength":6,"opacity":0.2,"shape":"oval","blurredParts":["breast","custom_1753644695715"],"overlayPositions":{"breast":{"x":1431,"y":1831,"width":192,"height":153,"confidence":82.45043158531189},"custom_1753644695715":{"x":548,"y":2105,"width":181,"height":175,"confidence":100}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 119
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 3 items
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753644785467-83966417.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 120
Query test with limit/offset interpolation
Query executed successfully, got 4 items
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Approve blur request for ID: 118
Request body: {
  blur_settings: {
    strength: 9,
    opacity: 0.2,
    shape: 'oval',
    blurredParts: [ 'breast', 'custom_1753644816667' ],
    overlayPositions: { breast: [Object], custom_1753644816667: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 9,
    "opacity": 0.2,
    "shape": "oval",
    "blurredParts": [
      "breast",
      "custom_1753644816667"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1470,
        "y": 1831,
        "width": 161,
        "height": 161,
        "confidence": 82.45043158531189
      },
      "custom_1753644816667": {
        "x": 526,
        "y": 2068,
        "width": 226,
        "height": 235,
        "confidence": 100
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 9,
  opacity: 0.2,
  shape: 'oval',
  blurredParts: [ 'breast', 'custom_1753644816667' ],
  overlayPositions: {
    breast: {
      x: 1470,
      y: 1831,
      width: 161,
      height: 161,
      confidence: 82.45043158531189
    },
    custom_1753644816667: { x: 526, y: 2068, width: 226, height: 235, confidence: 100 }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
=== SHAPE DEBUG START ===
blur_settings received: {
  "strength": 9,
  "opacity": 0.2,
  "shape": "oval",
  "blurredParts": [
    "breast",
    "custom_1753644816667"
  ],
  "overlayPositions": {
    "breast": {
      "x": 1470,
      "y": 1831,
      "width": 161,
      "height": 161,
      "confidence": 82.45043158531189
    },
    "custom_1753644816667": {
      "x": 526,
      "y": 2068,
      "width": 226,
      "height": 235,
      "confidence": 100
    }
  }
}
shape value: oval
shape type: string
=== SHAPE DEBUG END ===
Starting blur processing...
Creating blurred version with settings: {
  strength: 9,
  opacity: 0.2,
  shape: 'oval',
  blurredParts: [ 'breast', 'custom_1753644816667' ],
  overlayPositions: {
    breast: {
      x: 1470,
      y: 1831,
      width: 161,
      height: 161,
      confidence: 82.45043158531189
    },
    custom_1753644816667: { x: 526, y: 2068, width: 226, height: 235, confidence: 100 }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753644785474_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644849998_1753644785474_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1470,
  y: 1831,
  width: 161,
  height: 161,
  confidence: 82.45043158531189
}
custom_1753644816667 coordinates from admin interface: { x: 526, y: 2068, width: 226, height: 235, confidence: 100 }
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast', 'custom_1753644816667' ]
Processing blur for breast (received coords): {
  x: 1470,
  y: 1831,
  width: 161,
  height: 161,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1470, y=1831, w=161, h=161
  Raw coords: x=1831, y=577, w=161, h=161
Final blur coordinates for processing: 1831,577 161x161
Composite will use admin coordinates after rotation: 1470,1831
DEBUG: Would extract region at 1831,577 161x161
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 9px blur...
Blur shape setting received: 'oval' (type: string)
DEBUG: Using shape = 'oval' (original was 'oval')
TESTING: actualShape='oval', blurShape='oval'
*** OVAL SHAPE DETECTED - APPLYING CIRCULAR MASK ***
Applying oval shape to breast blur region
Creating oval mask with radius 78 for 161x161 region
Creating circular mask using SVG approach
Applied circular mask using SVG with radius 79.5
Successfully applied oval mask to breast
DEBUG: Applied 9px blur to breast region
Applying circular shape to white overlay to match blur
Extracted from RAW image at: 1831,577 161x161
Applied blur radius: 9px (9px setting)
Applied white overlay with 20% opacity (enhanced from 20%)
Preparing for composite at: 1470,1831
Processing blur for custom_1753644816667 (received coords): { x: 526, y: 2068, width: 226, height: 235, confidence: 100 }
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=526, y=2068, w=226, h=235
  Raw coords: x=2068, y=1456, w=235, h=226
Final blur coordinates for processing: 2068,1456 235x226
Composite will use admin coordinates after rotation: 526,2068
DEBUG: Would extract region at 2068,1456 235x226
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 9px blur...
Blur shape setting received: 'oval' (type: string)
DEBUG: Using shape = 'oval' (original was 'oval')
TESTING: actualShape='oval', blurShape='oval'
*** OVAL SHAPE DETECTED - APPLYING CIRCULAR MASK ***
Applying oval shape to custom_1753644816667 blur region
Creating oval mask with radius 111 for 226x235 region
Creating circular mask using SVG approach
Applied circular mask using SVG with radius 112
Successfully applied oval mask to custom_1753644816667
DEBUG: Applied 9px blur to custom_1753644816667 region
Applying circular shape to white overlay to match blur
Extracted from RAW image at: 2068,1456 235x226
Applied blur radius: 9px (9px setting)
Applied white overlay with 20% opacity (enhanced from 20%)
Preparing for composite at: 526,2068
Applying 2 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Attempting to save processed image to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644849998_1753644785474_20250622_003419.jpg
SUCCESS: Blurred image saved successfully to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753644849998_1753644785474_20250622_003419.jpg
File verification - Size: 1059817 bytes
Blur processing completed, path: /uploads/escort-example/public/blurred/blurred_1753644849998_1753644785474_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753644785474_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753644785474_20250622_003419.jpg
Updating content_moderation record with ID: 120
Blur settings JSON: {"strength":9,"opacity":0.2,"shape":"oval","blurredParts":["breast","custom_1753644816667"],"overlayPositions":{"breast":{"x":1470,"y":1831,"width":161,"height":161,"confidence":82.45043158531189},"custom_1753644816667":{"x":526,"y":2068,"width":226,"height":235,"confidence":100}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 120
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 3 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Approve blur request for ID: 115
Request body: {
  blur_settings: {
    strength: 6,
    opacity: 0.2,
    shape: 'oval',
    blurredParts: [ 'genitalia' ],
    overlayPositions: { genitalia: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 6,
    "opacity": 0.2,
    "shape": "oval",
    "blurredParts": [
      "genitalia"
    ],
    "overlayPositions": {
      "genitalia": {
        "x": 2069,
        "y": 2340,
        "width": 538,
        "height": 645,
        "confidence": 26.578259468078613
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 6,
  opacity: 0.2,
  shape: 'oval',
  blurredParts: [ 'genitalia' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2340,
      width: 538,
      height: 645,
      confidence: 26.578259468078613
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
=== SHAPE DEBUG START ===
blur_settings received: {
  "strength": 6,
  "opacity": 0.2,
  "shape": "oval",
  "blurredParts": [
    "genitalia"
  ],
  "overlayPositions": {
    "genitalia": {
      "x": 2069,
      "y": 2340,
      "width": 538,
      "height": 645,
      "confidence": 26.578259468078613
    }
  }
}
shape value: oval
shape type: string
=== SHAPE DEBUG END ===
Starting blur processing...
Creating blurred version with settings: {
  strength: 6,
  opacity: 0.2,
  shape: 'oval',
  blurredParts: [ 'genitalia' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2340,
      width: 538,
      height: 645,
      confidence: 26.578259468078613
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753644417554_20230703_111727.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753645144721_1753644417554_20230703_111727.jpg
=== COORDINATE DEBUGGING START ===
genitalia coordinates from admin interface: {
  x: 2069,
  y: 2340,
  width: 538,
  height: 645,
  confidence: 26.578259468078613
}
Raw image dimensions: 4000 x 3000 orientation: 1
Auto-rotated image dimensions: 4000 x 3000
Applying selective blur to regions: [ 'genitalia' ]
Processing blur for genitalia (received coords): {
  x: 2069,
  y: 2340,
  width: 538,
  height: 645,
  confidence: 26.578259468078613
}
Auto-rotated image dimensions: 4000x3000
No coordinate transformation needed:
  Direct coords: x=2069, y=2340, w=538, h=645
Final blur coordinates for processing: 2069,2340 538x645
DEBUG: Would extract region at 2069,2340 538x645
Creating blurred region with 6px blur...
Blur shape setting received: 'oval' (type: string)
DEBUG: Using shape = 'oval' (original was 'oval')
TESTING: actualShape='oval', blurShape='oval'
*** OVAL SHAPE DETECTED - APPLYING CIRCULAR MASK ***
Applying oval shape to genitalia blur region
Creating oval mask with radius 267 for 538x645 region
Creating circular mask using SVG approach
Applied circular mask using SVG with radius 268
Successfully applied oval mask to genitalia
DEBUG: Applied 6px blur to genitalia region
Creating white overlay with opacity: 0.7000000000000001 (70%)
Applying circular shape to white overlay to match blur
Compositing white overlay onto blurred region...
White overlay composite completed
Extracted from RAW image at: 2069,2340 538x645
Applied blur radius: 6px (6px setting)
Applied white overlay with 70% opacity (enhanced from 20%)
Preparing for composite at: 2069,2340
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Attempting to save processed image to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753645144721_1753644417554_20230703_111727.jpg
SUCCESS: Blurred image saved successfully to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753645144721_1753644417554_20230703_111727.jpg
File verification - Size: 4187904 bytes
Blur processing completed, path: /uploads/escort-example/public/blurred/blurred_1753645144721_1753644417554_20230703_111727.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753644417554_20230703_111727.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753644417554_20230703_111727.jpg
Updating content_moderation record with ID: 117
Blur settings JSON: {"strength":6,"opacity":0.2,"shape":"oval","blurredParts":["genitalia"],"overlayPositions":{"genitalia":{"x":2069,"y":2340,"width":538,"height":645,"confidence":26.578259468078613}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 117
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 2 items
Approve blur request for ID: 114
Request body: {
  blur_settings: {
    strength: 15,
    opacity: 0.2,
    shape: 'rounded',
    blurredParts: [ 'genitalia', 'custom_1753645232145' ],
    overlayPositions: { genitalia: [Object], custom_1753645232145: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 15,
    "opacity": 0.2,
    "shape": "rounded",
    "blurredParts": [
      "genitalia",
      "custom_1753645232145"
    ],
    "overlayPositions": {
      "genitalia": {
        "x": 2069,
        "y": 2340,
        "width": 538,
        "height": 645,
        "confidence": 26.578259468078613
      },
      "custom_1753645232145": {
        "x": 1803,
        "y": 1715,
        "width": 364,
        "height": 225,
        "confidence": 100
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 15,
  opacity: 0.2,
  shape: 'rounded',
  blurredParts: [ 'genitalia', 'custom_1753645232145' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2340,
      width: 538,
      height: 645,
      confidence: 26.578259468078613
    },
    custom_1753645232145: { x: 1803, y: 1715, width: 364, height: 225, confidence: 100 }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
=== SHAPE DEBUG START ===
blur_settings received: {
  "strength": 15,
  "opacity": 0.2,
  "shape": "rounded",
  "blurredParts": [
    "genitalia",
    "custom_1753645232145"
  ],
  "overlayPositions": {
    "genitalia": {
      "x": 2069,
      "y": 2340,
      "width": 538,
      "height": 645,
      "confidence": 26.578259468078613
    },
    "custom_1753645232145": {
      "x": 1803,
      "y": 1715,
      "width": 364,
      "height": 225,
      "confidence": 100
    }
  }
}
shape value: rounded
shape type: string
=== SHAPE DEBUG END ===
Starting blur processing...
Creating blurred version with settings: {
  strength: 15,
  opacity: 0.2,
  shape: 'rounded',
  blurredParts: [ 'genitalia', 'custom_1753645232145' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2340,
      width: 538,
      height: 645,
      confidence: 26.578259468078613
    },
    custom_1753645232145: { x: 1803, y: 1715, width: 364, height: 225, confidence: 100 }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753644395487_20230703_111727.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753645272359_1753644395487_20230703_111727.jpg
=== COORDINATE DEBUGGING START ===
genitalia coordinates from admin interface: {
  x: 2069,
  y: 2340,
  width: 538,
  height: 645,
  confidence: 26.578259468078613
}
custom_1753645232145 coordinates from admin interface: { x: 1803, y: 1715, width: 364, height: 225, confidence: 100 }
Raw image dimensions: 4000 x 3000 orientation: 1
Auto-rotated image dimensions: 4000 x 3000
Applying selective blur to regions: [ 'genitalia', 'custom_1753645232145' ]
Processing blur for genitalia (received coords): {
  x: 2069,
  y: 2340,
  width: 538,
  height: 645,
  confidence: 26.578259468078613
}
Auto-rotated image dimensions: 4000x3000
No coordinate transformation needed:
  Direct coords: x=2069, y=2340, w=538, h=645
Final blur coordinates for processing: 2069,2340 538x645
DEBUG: Would extract region at 2069,2340 538x645
Creating blurred region with 15px blur...
Blur shape setting received: 'rounded' (type: string)
DEBUG: Using shape = 'rounded' (original was 'rounded')
TESTING: actualShape='rounded', blurShape='rounded'
Using rectangular blur for genitalia (shape: rounded)
DEBUG: Applied 15px blur to genitalia region
Creating white overlay with opacity: 0.7000000000000001 (70%)
Compositing white overlay onto blurred region...
White overlay composite completed
Extracted from RAW image at: 2069,2340 538x645
Applied blur radius: 15px (15px setting)
Applied white overlay with 70% opacity (enhanced from 20%)
Preparing for composite at: 2069,2340
Processing blur for custom_1753645232145 (received coords): { x: 1803, y: 1715, width: 364, height: 225, confidence: 100 }
Auto-rotated image dimensions: 4000x3000
No coordinate transformation needed:
  Direct coords: x=1803, y=1715, w=364, h=225
Final blur coordinates for processing: 1803,1715 364x225
DEBUG: Would extract region at 1803,1715 364x225
Creating blurred region with 15px blur...
Blur shape setting received: 'rounded' (type: string)
DEBUG: Using shape = 'rounded' (original was 'rounded')
TESTING: actualShape='rounded', blurShape='rounded'
Using rectangular blur for custom_1753645232145 (shape: rounded)
DEBUG: Applied 15px blur to custom_1753645232145 region
Creating white overlay with opacity: 0.7000000000000001 (70%)
Compositing white overlay onto blurred region...
White overlay composite completed
Extracted from RAW image at: 1803,1715 364x225
Applied blur radius: 15px (15px setting)
Applied white overlay with 70% opacity (enhanced from 20%)
Preparing for composite at: 1803,1715
Applying 2 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Attempting to save processed image to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753645272359_1753644395487_20230703_111727.jpg
SUCCESS: Blurred image saved successfully to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753645272359_1753644395487_20230703_111727.jpg
File verification - Size: 4156595 bytes
Blur processing completed, path: /uploads/escort-example/public/blurred/blurred_1753645272359_1753644395487_20230703_111727.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753644395487_20230703_111727.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753644395487_20230703_111727.jpg
Updating content_moderation record with ID: 116
Blur settings JSON: {"strength":15,"opacity":0.2,"shape":"rounded","blurredParts":["genitalia","custom_1753645232145"],"overlayPositions":{"genitalia":{"x":2069,"y":2340,"width":538,"height":645,"confidence":26.578259468078613},"custom_1753645232145":{"x":1803,"y":1715,"width":364,"height":225,"confidence":100}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 116
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 1 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Approve blur request for ID: 110
Request body: {
  blur_settings: {
    strength: 5,
    opacity: 0.1,
    shape: 'rounded',
    blurredParts: [ 'genitalia', 'custom_1753645428079' ],
    overlayPositions: { genitalia: [Object], custom_1753645428079: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 5,
    "opacity": 0.1,
    "shape": "rounded",
    "blurredParts": [
      "genitalia",
      "custom_1753645428079"
    ],
    "overlayPositions": {
      "genitalia": {
        "x": 2069,
        "y": 2340,
        "width": 538,
        "height": 645,
        "confidence": 26.578259468078613
      },
      "custom_1753645428079": {
        "x": 1803,
        "y": 1720,
        "width": 312,
        "height": 246,
        "confidence": 100
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 5,
  opacity: 0.1,
  shape: 'rounded',
  blurredParts: [ 'genitalia', 'custom_1753645428079' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2340,
      width: 538,
      height: 645,
      confidence: 26.578259468078613
    },
    custom_1753645428079: { x: 1803, y: 1720, width: 312, height: 246, confidence: 100 }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
=== SHAPE DEBUG START ===
blur_settings received: {
  "strength": 5,
  "opacity": 0.1,
  "shape": "rounded",
  "blurredParts": [
    "genitalia",
    "custom_1753645428079"
  ],
  "overlayPositions": {
    "genitalia": {
      "x": 2069,
      "y": 2340,
      "width": 538,
      "height": 645,
      "confidence": 26.578259468078613
    },
    "custom_1753645428079": {
      "x": 1803,
      "y": 1720,
      "width": 312,
      "height": 246,
      "confidence": 100
    }
  }
}
shape value: rounded
shape type: string
=== SHAPE DEBUG END ===
Starting blur processing...
Creating blurred version with settings: {
  strength: 5,
  opacity: 0.1,
  shape: 'rounded',
  blurredParts: [ 'genitalia', 'custom_1753645428079' ],
  overlayPositions: {
    genitalia: {
      x: 2069,
      y: 2340,
      width: 538,
      height: 645,
      confidence: 26.578259468078613
    },
    custom_1753645428079: { x: 1803, y: 1720, width: 312, height: 246, confidence: 100 }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753644175458_20230703_111727.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753645456243_1753644175458_20230703_111727.jpg
=== COORDINATE DEBUGGING START ===
genitalia coordinates from admin interface: {
  x: 2069,
  y: 2340,
  width: 538,
  height: 645,
  confidence: 26.578259468078613
}
custom_1753645428079 coordinates from admin interface: { x: 1803, y: 1720, width: 312, height: 246, confidence: 100 }
Raw image dimensions: 4000 x 3000 orientation: 1
Auto-rotated image dimensions: 4000 x 3000
Applying selective blur to regions: [ 'genitalia', 'custom_1753645428079' ]
Processing blur for genitalia (received coords): {
  x: 2069,
  y: 2340,
  width: 538,
  height: 645,
  confidence: 26.578259468078613
}
Auto-rotated image dimensions: 4000x3000
No coordinate transformation needed:
  Direct coords: x=2069, y=2340, w=538, h=645
Final blur coordinates for processing: 2069,2340 538x645
DEBUG: Would extract region at 2069,2340 538x645
Creating blurred region with 5px blur...
Blur shape setting received: 'rounded' (type: string)
DEBUG: Using shape = 'rounded' (original was 'rounded')
TESTING: actualShape='rounded', blurShape='rounded'
*** OVAL SHAPE DETECTED - APPLYING CIRCULAR MASK ***
Applying oval shape to genitalia blur region
Creating oval mask with radius 267 for 538x645 region
Creating circular mask using SVG approach
Applied circular mask using SVG with radius 268
Successfully applied oval mask to genitalia
DEBUG: Applied 5px blur to genitalia region
Creating white overlay with opacity: 0.35000000000000003 (35%)
Applying circular shape to white overlay to match blur
Compositing white overlay onto blurred region...
White overlay composite completed
Extracted from RAW image at: 2069,2340 538x645
Applied blur radius: 5px (5px setting)
Applied white overlay with 35% opacity (enhanced from 10%)
Preparing for composite at: 2069,2340
Processing blur for custom_1753645428079 (received coords): { x: 1803, y: 1720, width: 312, height: 246, confidence: 100 }
Auto-rotated image dimensions: 4000x3000
No coordinate transformation needed:
  Direct coords: x=1803, y=1720, w=312, h=246
Final blur coordinates for processing: 1803,1720 312x246
DEBUG: Would extract region at 1803,1720 312x246
Creating blurred region with 5px blur...
Blur shape setting received: 'rounded' (type: string)
DEBUG: Using shape = 'rounded' (original was 'rounded')
TESTING: actualShape='rounded', blurShape='rounded'
*** OVAL SHAPE DETECTED - APPLYING CIRCULAR MASK ***
Applying oval shape to custom_1753645428079 blur region
Creating oval mask with radius 121 for 312x246 region
Creating circular mask using SVG approach
Applied circular mask using SVG with radius 122
Successfully applied oval mask to custom_1753645428079
DEBUG: Applied 5px blur to custom_1753645428079 region
Creating white overlay with opacity: 0.35000000000000003 (35%)
Applying circular shape to white overlay to match blur
Compositing white overlay onto blurred region...
White overlay composite completed
Extracted from RAW image at: 1803,1720 312x246
Applied blur radius: 5px (5px setting)
Applied white overlay with 35% opacity (enhanced from 10%)
Preparing for composite at: 1803,1720
Applying 2 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Attempting to save processed image to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753645456243_1753644175458_20230703_111727.jpg
SUCCESS: Blurred image saved successfully to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753645456243_1753644175458_20230703_111727.jpg
File verification - Size: 4185156 bytes
Blur processing completed, path: /uploads/escort-example/public/blurred/blurred_1753645456243_1753644175458_20230703_111727.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753644175458_20230703_111727.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753644175458_20230703_111727.jpg
Updating content_moderation record with ID: 112
Blur settings JSON: {"strength":5,"opacity":0.1,"shape":"rounded","blurredParts":["genitalia","custom_1753645428079"],"overlayPositions":{"genitalia":{"x":2069,"y":2340,"width":538,"height":645,"confidence":26.578259468078613},"custom_1753645428079":{"x":1803,"y":1720,"width":312,"height":246,"confidence":100}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 112
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 0 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753645676250-86435534.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 121
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753645680156-226891565.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 122
Received upload request: {
  model_id: '1',
  model_slug: 'escort-example',
  usage_intent: 'public_site',
  context_type: 'public_gallery',
  file: '20250622_003419.jpg'
}
Processing upload for model escort-example with intent: public_site
ContentModerationService processing: {
  filePath: '/Users/programmer/Projects/musenest/temp_uploads/temp-1753645683401-500627002.jpg',
  originalName: '20250622_003419.jpg',
  modelId: 1,
  modelSlug: 'escort-example',
  usageIntent: 'public_site',
  contextType: 'public_gallery'
}
Folder structure created for model: escort-example
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Error loading moderation rules: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/src/services/ContentModerationService.js:31:33
    at Array.forEach (<anonymous>)
    at ContentModerationService.loadModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:28:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ContentModerationService.applyModerationRules (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:263:54)
    at async ContentModerationService.processUploadedImage (/Users/programmer/Projects/musenest/src/services/ContentModerationService.js:140:38)
    at async /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:88:24
Content flagged and added to moderation queue: 123
Query test with limit/offset interpolation
Query executed successfully, got 3 items
Queue fetch error: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:245:34
    at Array.map (<anonymous>)
    at /Users/programmer/Projects/musenest/routes/api/enhanced-content-moderation.js:243:42
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
Approve blur request for ID: 121
Request body: {
  blur_settings: {
    strength: 15,
    opacity: 0.8,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 15,
    "opacity": 0.8,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1264,
        "y": 1808,
        "width": 413,
        "height": 322,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1264,
      y: 1808,
      width: 413,
      height: 322,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
=== SHAPE DEBUG START ===
blur_settings received: {
  "strength": 15,
  "opacity": 0.8,
  "shape": "rounded",
  "blurredParts": [
    "breast"
  ],
  "overlayPositions": {
    "breast": {
      "x": 1264,
      "y": 1808,
      "width": 413,
      "height": 322,
      "confidence": 82.45043158531189
    }
  }
}
shape value: rounded
shape type: string
=== SHAPE DEBUG END ===
Starting blur processing...
Creating blurred version with settings: {
  strength: 15,
  opacity: 0.8,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1264,
      y: 1808,
      width: 413,
      height: 322,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753645683408_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753645706851_1753645683408_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1264,
  y: 1808,
  width: 413,
  height: 322,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1264,
  y: 1808,
  width: 413,
  height: 322,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1264, y=1808, w=413, h=322
  Raw coords: x=1808, y=531, w=322, h=413
Final blur coordinates for processing: 1808,531 322x413
Composite will use admin coordinates after rotation: 1264,1808
DEBUG: Would extract region at 1808,531 322x413
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 15px blur...
Blur shape setting received: 'rounded' (type: string)
DEBUG: Using shape = 'rounded' (original was 'rounded')
TESTING: actualShape='rounded', blurShape='rounded'
*** ROUNDED SHAPE DETECTED - APPLYING ROUNDED RECTANGLE MASK ***
Applying rounded rectangle shape to breast blur region
Creating rounded rectangle mask with 64.4px corners for 413x322 region
Applied rounded rectangle mask with 64.4px corners
Successfully applied rounded mask to breast
DEBUG: Applied 15px blur to breast region
Creating white overlay with opacity: 1 (100%)
Applying rounded rectangle shape to white overlay to match blur
Compositing white overlay onto blurred region...
White overlay composite completed
Extracted from RAW image at: 1808,531 322x413
Applied blur radius: 15px (15px setting)
Applied white overlay with 100% opacity (enhanced from 80%)
Preparing for composite at: 1264,1808
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Attempting to save processed image to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753645706851_1753645683408_20250622_003419.jpg
SUCCESS: Blurred image saved successfully to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753645706851_1753645683408_20250622_003419.jpg
File verification - Size: 1049988 bytes
Blur processing completed, path: /uploads/escort-example/public/blurred/blurred_1753645706851_1753645683408_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753645683408_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753645683408_20250622_003419.jpg
Updating content_moderation record with ID: 123
Blur settings JSON: {"strength":15,"opacity":0.8,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1264,"y":1808,"width":413,"height":322,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 123
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 2 items
Approve blur request for ID: 120
Request body: {
  blur_settings: {
    strength: 8,
    opacity: 0.1,
    shape: 'rounded',
    blurredParts: [ 'breast' ],
    overlayPositions: { breast: [Object] }
  },
  admin_notes: '',
  reviewed_by: 1
}
Raw request body: {
  "blur_settings": {
    "strength": 8,
    "opacity": 0.1,
    "shape": "rounded",
    "blurredParts": [
      "breast"
    ],
    "overlayPositions": {
      "breast": {
        "x": 1394,
        "y": 1670,
        "width": 314,
        "height": 345,
        "confidence": 82.45043158531189
      }
    }
  },
  "admin_notes": "",
  "reviewed_by": 1
}
Extracted blur_settings: {
  strength: 8,
  opacity: 0.1,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1394,
      y: 1670,
      width: 314,
      height: 345,
      confidence: 82.45043158531189
    }
  }
}
Extracted admin_notes type and length: string 0
Extracted reviewed_by type and value: number 1
=== SHAPE DEBUG START ===
blur_settings received: {
  "strength": 8,
  "opacity": 0.1,
  "shape": "rounded",
  "blurredParts": [
    "breast"
  ],
  "overlayPositions": {
    "breast": {
      "x": 1394,
      "y": 1670,
      "width": 314,
      "height": 345,
      "confidence": 82.45043158531189
    }
  }
}
shape value: rounded
shape type: string
=== SHAPE DEBUG END ===
Starting blur processing...
Creating blurred version with settings: {
  strength: 8,
  opacity: 0.1,
  shape: 'rounded',
  blurredParts: [ 'breast' ],
  overlayPositions: {
    breast: {
      x: 1394,
      y: 1670,
      width: 314,
      height: 345,
      confidence: 82.45043158531189
    }
  }
}
Original path: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753645680162_20250622_003419.jpg
Output path: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753645752176_1753645680162_20250622_003419.jpg
=== COORDINATE DEBUGGING START ===
breast coordinates from admin interface: {
  x: 1394,
  y: 1670,
  width: 314,
  height: 345,
  confidence: 82.45043158531189
}
Raw image dimensions: 2944 x 2208 orientation: 6
Auto-rotated image dimensions: 2944 x 2208
Applying selective blur to regions: [ 'breast' ]
Processing blur for breast (received coords): {
  x: 1394,
  y: 1670,
  width: 314,
  height: 345,
  confidence: 82.45043158531189
}
Auto-rotated image dimensions: 2944x2208
EXIF 6 coordinate transformation:
  Admin coords: x=1394, y=1670, w=314, h=345
  Raw coords: x=1670, y=500, w=345, h=314
Final blur coordinates for processing: 1670,500 345x314
Composite will use admin coordinates after rotation: 1394,1670
DEBUG: Would extract region at 1670,500 345x314
Rotated extracted region 90° clockwise to match final image orientation
Creating blurred region with 8px blur...
Blur shape setting received: 'rounded' (type: string)
DEBUG: Using shape = 'rounded' (original was 'rounded')
TESTING: actualShape='rounded', blurShape='rounded'
*** ROUNDED SHAPE DETECTED - APPLYING ROUNDED RECTANGLE MASK ***
Applying rounded rectangle shape to breast blur region
Creating rounded rectangle mask with 62.800000000000004px corners for 314x345 region
Applied rounded rectangle mask with 62.800000000000004px corners
Successfully applied rounded mask to breast
DEBUG: Applied 8px blur to breast region
Creating white overlay with opacity: 0.35000000000000003 (35%)
Applying rounded rectangle shape to white overlay to match blur
Compositing white overlay onto blurred region...
White overlay composite completed
Extracted from RAW image at: 1670,500 345x314
Applied blur radius: 8px (8px setting)
Applied white overlay with 35% opacity (enhanced from 10%)
Preparing for composite at: 1394,1670
Applying 1 blur regions in single composite operation
Applying EXIF rotation to final output for proper display orientation
Attempting to save processed image to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753645752176_1753645680162_20250622_003419.jpg
SUCCESS: Blurred image saved successfully to: /Users/programmer/Projects/musenest/public/uploads/escort-example/public/blurred/blurred_1753645752176_1753645680162_20250622_003419.jpg
File verification - Size: 1055099 bytes
Blur processing completed, path: /uploads/escort-example/public/blurred/blurred_1753645752176_1753645680162_20250622_003419.jpg
Media file moved: /Users/programmer/Projects/musenest/public/uploads/escort-example/originals/1753645680162_20250622_003419.jpg → /Users/programmer/Projects/musenest/public/uploads/escort-example/public/1753645680162_20250622_003419.jpg
Updating content_moderation record with ID: 122
Blur settings JSON: {"strength":8,"opacity":0.1,"shape":"rounded","blurredParts":["breast"],"overlayPositions":{"breast":{"x":1394,"y":1670,"width":314,"height":345,"confidence":82.45043158531189}}}
Admin notes: 
Reviewed by: 1
Starting content_moderation update process...
Content moderation ID: 122
Content moderation update successful, affected rows: undefined
Verified record after update: { moderation_status: 'approved', final_location: 'public_blurred' }
Query test with limit/offset interpolation
Query executed successfully, got 1 items
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
🔍 Testing database connection...
✅ Database connected successfully
🚀 MuseNest Server Started
📍 Server running on port 3000
🌍 Environment: development
🔗 Health check: http://localhost:3000/health

Next steps:
1. Copy .env.example to .env and configure your database
2. Run: npm run migrate (to set up database)
3. Run: npm run seed (to add sample data)
Loaded 0 active impersonation sessions
